<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>karl</title><link>https://karlquinsland.com/</link><description>Karl's little corner of the internet</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 01 Jan 2026 00:00:00 +0000</lastBuildDate><atom:link href="https://karlquinsland.com/index.xml" rel="self" type="application/rss+xml"/><item><title>Frigate in Kubernetes</title><link>https://karlquinsland.com/frigate-in-k8s/</link><pubDate>Thu, 01 Jan 2026 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/frigate-in-k8s/</guid><description><![CDATA[<!-- markdownlint-disable-file MD002 -->
<h1 id="frigate-kubernetes-edition">Frigate: Kubernetes edition</h1>
<p>This is a follow up to my <a href="/frigate-install/" rel="">&lsquo;Frigate From Scratch&rsquo; post</a>.
Most of that post is still relevant today but I have since moved almost all of my workloads into Kubernetes.</p>
<p>This post is intended to document some of the issues I hit while trying to get Frigate running in my k8s cluster.
This is not every issue I hit, just the ones that are not directly related to my specific environment/setup/workflows.</p>
<p>I have essentially taken the relevant parts of my notes and lightly edited them into a more organized and structured format.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<h2 id="overview">Overview</h2>
<p>There is a <a href="https://github.com/blakeblackshear/blakeshome-charts" target="_blank" rel="noopener noreffer ">helm chart</a> but Frigate - at least <em>outside</em> of the container - is not a particularly complex deployment so there&rsquo;s no upside to using helm and just a <strong>ton</strong> of downside:</p>
<ul>
<li><a href="https://news.ycombinator.com/item?id=45902604" target="_blank" rel="noopener noreffer ">Helm 4.0 | Hacker News</a></li>
<li><a href="https://news.ycombinator.com/item?id=24499272" target="_blank" rel="noopener noreffer ">`helm` is an absolute garbage. I&rsquo;ll reserve judgment about `kustomize` until I h...</a></li>
<li><a href="https://news.ycombinator.com/item?id=44506696" target="_blank" rel="noopener noreffer ">Helm local code execution via a malicious chart</a></li>
<li><a href="https://news.ycombinator.com/item?id=19580025" target="_blank" rel="noopener noreffer ">We use Helm, but we really only use it for two things: Templating and atomic dep...</a></li>
<li><a href="https://glasskube.eu/en/r/knowledge/5-helm-shortcomings/" target="_blank" rel="noopener noreffer ">5 shortcomings of Helm | Glasskube</a></li>
<li><a href="https://news.ycombinator.com/item?id=21526894" target="_blank" rel="noopener noreffer ">Helm is problematic in my view. To new Kubernetes users, Helm appears to be the ...</a></li>
<li><a href="https://news.ycombinator.com/item?id=11100312" target="_blank" rel="noopener noreffer ">Helm may be the most flagrant example of a terrible package that remains inexpli...</a></li>
<li><a href="https://blog.devops.dev/why-helms-design-is-flawed-a66c07c2e9a1?gi=6078bb173b62" target="_blank" rel="noopener noreffer ">Why Helm’s design is flawed</a></li>
</ul>
<p><code>&lt;/rant&gt;</code></p>
<p>You can still use the <code>helm</code> chart as a reference for the various ports and volume mounts that need to be configured:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">❯ helm repo add blakeshome https://blakeblackshear.github.io/blakeshome-charts/
</span></span><span class="line"><span class="cl"><span class="s2">&#34;blakeshome&#34;</span> has been added to your repositories
</span></span><span class="line"><span class="cl"><span class="c1"># use --set to enable things like startup probes and coral support to get a better reference manifest</span>
</span></span><span class="line"><span class="cl">❯ helm template blakeshome blakeshome/frigate --set probes.startup.enabled<span class="o">=</span><span class="nb">true</span> --set coral.enabled<span class="o">=</span><span class="nb">true</span> --set coral.hostPath<span class="o">=</span>/dev/apex_0 &gt; reference.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pain-points">Pain Points</h2>
<p>Below are two pain points I hit while getting Frigate running in k8s that are also likely to be relevant to others.
Hopefully the notes here will save you some time!</p>
<h3 id="coral-pass-through">Coral pass through</h3>
<p>Frigate now supports <em>several</em> different <a href="https://docs.frigate.video/frigate/hardware/#detectors" target="_blank" rel="noopener noreffer ">hardware acceleration</a> options for object detection.
I am still using the PCIe Coral EdgeTPU as the performance is excellent although that will likely change in the future as other options become available.</p>
<p>To prepare for a future where I might have multiple viable hardware acceleration options available in my k8s cluster, I have elected to use <a href="#nfd" rel="">NFD (Node Feature Discovery)</a> to label nodes that have Coral TPUs installed.
This is not particularly difficult to do <em>but it is also <strong>unnecessary</strong> if you only have a single node that will run Frigate</em>; regular taint/toleration or nodeSelector approaches will work just fine.</p>
<p>Regardless, the Coral drivers need to be installed on the node(s) that will host the Coral device(s).</p>
<p>The good news is that the process of manually patching and compiling the drivers has been made less tedious by the community!
So long as you are on a modern-ish Debian based system, the <a href="https://github.com/jnicolson/gasket-builder" target="_blank" rel="noopener noreffer ">jnicolson/gasket-builder repo</a> has automated the process of installing the <a href="https://en.wikipedia.org/wiki/Dynamic_Kernel_Module_Support" target="_blank" rel="noopener noreffer "><code>DKMS</code> drivers</a> for the Coral TPU.</p>
<p>You don&rsquo;t have to:</p>
<ul>
<li>track down a few unmerged patches and apply them</li>
<li>figure out how to build the drivers against your current kernel</li>
<li>manually load the modules</li>
<li>create and load udev rules</li>
<li>&hellip; etc</li>
</ul>
<p>You will still need kernel headers and basic build tools installed on the host but beyond that it&rsquo;s really just a matter of <code>wget ...; dpkg -i ...</code> and a <code>reboot now</code> for good measure.</p>
<p>Once the drivers are installed, you should see the devices show up under <code>/dev/apex_*</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">root@panopticon01:/mnt/frigate# ls -lah /dev/apex_*
</span></span><span class="line"><span class="cl">crw-rw---- <span class="m">1</span> root apex 120, <span class="m">0</span> Dec <span class="m">30</span> 10:01 /dev/apex_0
</span></span><span class="line"><span class="cl">crw-rw---- <span class="m">1</span> root apex 120, <span class="m">1</span> Dec <span class="m">30</span> 10:01 /dev/apex_1
</span></span></code></pre></td></tr></table>
</div>
</div><p>Assuming the devices are detected, you can then pass them through to the container as regular <code>hostPath</code> volumes.
Unfortunately, there is no k8s equivalent of the <a href="https://docs.docker.com/reference/cli/docker/container/run/#device" target="_blank" rel="noopener noreffer "><code>--device</code> flag</a> and my attempts to use a tailored <code>securityContext</code> to grant the necessary permissions to access the devices failed:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">securityContext</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">privileged</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">capabilities</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">add</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># DMA access</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">IPC_LOCK</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Required for PCIe memory access</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">SYS_RAWIO</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="c"># Permit more things if needed</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">CAP_SYS_ADMIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Allow anything that wants to escalate privileges to do so...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">allowPrivilegeEscalation</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Kubernetes seems to prefer that hardware vendors create/ship a <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/" target="_blank" rel="noopener noreffer ">Device Plugin</a> to safely/cleanly facilitate accessing devices from inside pods but there is only a <a href="https://gitlab.com/mike-ensor/k8s-edge-tpu-device-plugin" target="_blank" rel="noopener noreffer ">very experimental one</a> for the Coral TPU at this time.</p>
<p>All of that is to say: <em>you <strong>will</strong> need to run the container in <code>privileged</code> mode for the device access to work correctly</em>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l">apps/v1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">Deployment</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># &lt;...&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">spec</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">containers</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">ghcr.io/blakeblackshear/frigate:0.16.3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">frigate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">securityContext</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="c"># Needed for the Frigate UI to show CPU/TPU metrics (usage/temp...etc)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="nt">capabilities</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                          </span><span class="nt">add</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                              </span>- <span class="l">CAP_PERFMON</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="c"># See note above</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="nt">privileged</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">volumeMounts</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="c"># Covered in the IPv6 section below</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span>- <span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/usr/local/nginx/templates/listen.gotmpl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-templates</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="nt">readOnly</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="nt">subPath</span><span class="p">:</span><span class="w"> </span><span class="l">listen.gotmpl</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span>- <span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/dev/apex_0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">coral-apex-0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span>- <span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l">/dev/apex_1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">coral-apex-1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c"># &lt;...&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c"># Covered in the NFD section below</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">nodeSelector</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">feature.node.kubernetes.io/has-pcie-tpu</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">configMap</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">frigate-nginx-templates</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">nginx-templates</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">hostPath</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/dev/apex_0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">coral-apex-0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="nt">hostPath</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                      </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/dev/apex_1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">coral-apex-1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c"># &lt;...&gt;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="nfd">NFD</h4>
<p><a href="https://github.com/kubernetes-sigs/node-feature-discovery" target="_blank" rel="noopener noreffer ">Node Feature Discovery</a> is a straight-forward project that puts a daemonset on each node in your cluster and scans the hardware for features.
Depending on what hardware it finds, it will label the node with appropriate labels that can then be used for scheduling.</p>
<div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw" aria-hidden="true"></i>Over Engineered<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">As noted <a href="#coral-pass-through" rel="">above</a>, NFD is not strictly necessary if you only have a single node that will run Frigate, just use a regular <code>nodeSelector</code> or taint/toleration approach instead.</div>
        </div>
    </div>
<p>I have some other workloads that can benefit from NFD so I went ahead and set it up cluster-wide.
Here is the relevant snippet from my NFD configuration that detects Coral TPUs and applies a label accordingly:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">core</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># The worker is cheap but it defaults to running every 60s which is excessive for a cluster that</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c">#    is all bare metal and not likely to have hardware changes often.</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">sleepInterval</span><span class="p">:</span><span class="w"> </span><span class="l">300s</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># all -&gt; make sure `pci` features are included</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Disable CPU features to reduce excessive labels</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">featureSources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="l">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;-cpu&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">labelSources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="l">all</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="s2">&#34;-cpu&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">sources</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pci</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># You only need `0880` for Coral but I have some other hardware that I use</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">deviceClassWhitelist</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c"># Network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="s2">&#34;02&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c"># Display</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="s2">&#34;03&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c"># Base class for System peripherals</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="s2">&#34;08&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c"># Specific class for Coral</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="s2">&#34;0880&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c"># Accelerator</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="s2">&#34;12&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">custom</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;has-coral-tpu&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">labels</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span><span class="nt">&#34;feature.node.kubernetes.io/has-pcie-tpu&#34;: </span><span class="s2">&#34;true&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">matchFeatures</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span>- <span class="nt">feature</span><span class="p">:</span><span class="w"> </span><span class="l">pci.device</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">matchExpressions</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="nt">vendor</span><span class="p">:</span><span class="w"> </span>{<span class="w"> </span><span class="nt">op: In, value</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;1ac1&#34;</span><span class="p">]</span><span class="w"> </span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="nt">device</span><span class="p">:</span><span class="w"> </span>{<span class="w"> </span><span class="nt">op: In, value</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;089a&#34;</span><span class="p">]</span><span class="w"> </span>}<span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Once NFD is deployed and running, each <code>kind: Node</code> in your cluster should have a label like so if it has a Coral TPU installed:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">❯ kubectl get nodes -l feature.node.kubernetes.io/has-pcie-tpu -o name
</span></span><span class="line"><span class="cl">node/panopticon01
</span></span></code></pre></td></tr></table>
</div>
</div><p>Combine that with the <code>nodeSelector</code> as shown in the snippet \above and Frigate will only be scheduled on nodes that have Coral TPUs installed.</p>
<h3 id="ipv6">IPv6</h3>
<p>It&rsquo;s 2026 and IPv6 should just work by default everywhere but alas, Frigate is still a bit behind the times in this regard.</p>
<p>The <a href="https://docs.frigate.video/configuration/advanced/#enabling-ipv6" target="_blank" rel="noopener noreffer ">docs</a> are very sparse but they do hint at having to make some modification to a file inside the container.</p>
<p>Above, I am providing my own copy of <code>/usr/local/nginx/templates/listen.gotmpl</code> via a <code>ConfigMap</code> volume mount to override the default one that ships with the container:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l">ConfigMap</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># &lt;...&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">data</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">listen.gotmpl</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        listen 5000;
</span></span></span><span class="line"><span class="cl"><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        {{ if not .enabled }}
</span></span></span><span class="line"><span class="cl"><span class="sd">        # intended for external traffic, protected by auth
</span></span></span><span class="line"><span class="cl"><span class="sd">        listen [::]:8971 ipv6only=off;
</span></span></span><span class="line"><span class="cl"><span class="sd">        {{ else }}
</span></span></span><span class="line"><span class="cl"><span class="sd">        # intended for external traffic, protected by auth
</span></span></span><span class="line"><span class="cl"><span class="sd">        listen [::]:8971 ipv6only=off ssl;
</span></span></span><span class="line"><span class="cl"><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        # intended for internal traffic, not protected by auth
</span></span></span><span class="line"><span class="cl"><span class="sd">        listen [::]:5000 ipv6only=off;
</span></span></span><span class="line"><span class="cl"><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">        {{ end }}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The above is more or less taken from <a href="https://github.com/blakeblackshear/frigate/issues/5275#issuecomment-2395553577" target="_blank" rel="noopener noreffer ">this GH issue</a> but modified slightly:</p>
<ul>
<li>The GH issue uses <code>[::1]</code> for some reason which only binds to the loopback interface and does not work for me. I changed it to just <code>[::]</code> to bind to all interfaces which is what I want for my use case.</li>
<li>The ACME/TLS stuff is not relevant to me so I removed that; I just handle TLS termination elsewhere in my stack.</li>
<li>There&rsquo;s still a ton of stuff inside the container that is IPv4 only but that&rsquo;s a problem for another day / does not violate my self-imposed &ldquo;IPv6 first, ideally exclusively&rdquo; requirement.</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Frigate puts all the complexity into the container so it&rsquo;s a pretty straight-forward deployment in k8s.
Things get a bit trickier when you start adding hardware acceleration into the mix but it&rsquo;s still manageable with a bit of effort.
For reasons that are beyond me, Frigate still does not have first-class IPv6 support so that requires a bit of manual tinkering as well.</p>
]]></description></item><item><title>#TwoMinuteTeardown: Multiple LED Controllers</title><link>https://karlquinsland.com/led-controllers/</link><pubDate>Fri, 26 Dec 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/led-controllers/</guid><description><![CDATA[<!-- markdownlint-disable MD024 -->
<h2 id="introduction">Introduction</h2>
<p>Bit of a change in format; instead of one <em>massive</em> post for all the misc. 11-11 teardowns, I&rsquo;m grouping them.
This post is the &ldquo;LED Controller&rdquo; group.
I managed to snag the following on Ali Express:</p>
<ul>
<li><a href="https://www.aliexpress.us/item/3256810107702305.html" target="_blank" rel="noopener noreffer ">Gledepto GL-C-618WL LED Controller</a></li>
<li><a href="https://www.aliexpress.us/item/3256810030310796.html" target="_blank" rel="noopener noreffer ">IoTorero LS11PDual LED Controller</a></li>
<li><a href="https://www.aliexpress.us/item/3256809568993977.html" target="_blank" rel="noopener noreffer ">SMLIGHT-A1-SLWF-09 LED Controller</a></li>
</ul>
<p>To continue from <a href="/aliexpress-11-11-sale-teardowns-2024/#side-note-the-ossha-community-is-being-heard" rel="">last year&rsquo;s trend</a>, I waned to celebrate that all three of these LED controllers have:</p>
<ul>
<li><a href="https://kno.wled.ge/" target="_blank" rel="noopener noreffer ">WLED</a> firmware flashed from the factory</li>
<li>GPIO labeled for hacking</li>
<li>No firmware lock-in; the USB interface shows up as a standard serial device on Linux so you don&rsquo;t even need to open it up to re-flash it!</li>
</ul>
<p>The broad changes compared to last year are:</p>
<ul>
<li>Designs are more modular, allowing for upgrades to be added to a flexible base design</li>
<li>Ethernet is a common upgrade option now for more reliable LAN control</li>
<li>PoE is an option on some models for easier deployment in locations without easy access to power outlets</li>
</ul>
<p>Beyond that, the internals are starting to converge on similar designs with similar components.
I have created an <code>ICs and Markings</code> section for each teardown to help identify the key components used in each design &hellip; but you&rsquo;ll see that the same chips keep showing up across multiple designs.</p>
<h2 id="gledepto-gl-c-618wl-led-controller">Gledepto GL-C-618WL LED Controller</h2>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>Each connector is labeled with the GPIO that drives it &lt;3.
Chunky user replicable fuse with a label stating the form factor and rating &lt;3.</p>
<p>Not pictured; the back of the device has no screws.
A simple pry tool is all you need to open it up.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>About what you&rsquo;d expect from a WLED controller. Layout seems reasonable and intuitive.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            That&#39;s glare form my light and leftover solder flux... not conformal coating.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Backside is boring but everything is well labeled.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Apparently if you order enough of them, Espressif will put your logo on the module.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>Not exactly sure why they have MOSFETS immediately after the power input <em>and</em> for the LED outputs.
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>

</p>
<p>It&rsquo;s not marked on the box or enclosure or mentioned in the product listing but it looks like you can select between termination resistors (24.9/33Ω) via switch.
This is a nice touch for reliability over long runs of LED strip &hellip; but I&rsquo;m not sure how many users will actually need to use it with that 74HC chip there.</p>
<p>No other controller I&rsquo;ve seen has this feature so far so I appreciate the attention to detail here.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>Beyond that, nice of them to mark what type of MIC is used and the GPIOs it&rsquo;s wired to.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>I would expect the fuse to be the over-current protection for the entire board&hellip;. so I&rsquo;m not sure why there&rsquo;s a pair of MOSFETs right after the DC input.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<h3 id="misc">Misc</h3>
<h4 id="ics-and-markings">ICs and Markings</h4>
<ul>
<li><a href="https://all-power.com/module/product/manual_download.php?b_idx=1520&amp;idx=719" target="_blank" rel="noopener noreffer "><code>All Power G050N06K</code></a>:</li>
<li><a href="https://all-power.com/module/product/manual_download.php?b_idx=868&amp;idx=501" target="_blank" rel="noopener noreffer "><code>All Power 126P03K</code></a></li>
<li><a href="https://ww1.microchip.com/downloads/en/devicedoc/8720a.pdf" target="_blank" rel="noopener noreffer "><code>SMSC 8720A</code></a>: Ethernet PHY</li>
<li><a href="https://www.lcsc.com/datasheet/C968586.pdf" target="_blank" rel="noopener noreffer "><code>CH340K</code></a>: Handles the USB to UART conversion</li>
<li><a href="https://assets.nexperia.com/documents/data-sheet/74HC_HCT125.pdf" target="_blank" rel="noopener noreffer "><code>Nexperia 74HCT125D</code></a></li>
</ul>
<h4 id="dmesg"><code>dmesg</code></h4>
<p>When plugged in via USB, shows up as a CH341 device:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># dmesg</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.814962<span class="o">]</span> usb 5-4.1.4: new full-speed USB device number <span class="m">77</span> using xhci_hcd
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.914683<span class="o">]</span> usb 5-4.1.4: New USB device found, <span class="nv">idVendor</span><span class="o">=</span>1a86, <span class="nv">idProduct</span><span class="o">=</span>7522, <span class="nv">bcdDevice</span><span class="o">=</span> 2.64
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.914688<span class="o">]</span> usb 5-4.1.4: New USB device strings: <span class="nv">Mfr</span><span class="o">=</span>0, <span class="nv">Product</span><span class="o">=</span>2, <span class="nv">SerialNumber</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.914690<span class="o">]</span> usb 5-4.1.4: Product: USB Serial
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.986923<span class="o">]</span> usbcore: registered new interface driver ch341
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.986940<span class="o">]</span> usbserial: USB Serial support registered <span class="k">for</span> ch341-uart
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.986960<span class="o">]</span> ch341 5-4.1.4:1.0: ch341-uart converter detected
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.999771<span class="o">]</span> usb 5-4.1.4: ch341-uart converter now attached to ttyUSB0
</span></span></code></pre></td></tr></table>
</div>
</div><p>I did not bother trying to check for logging output over the serial interface since WLED is already installed and there&rsquo;s no mystery firmware to reverse engineer.</p>
<h2 id="iotorero-ls11pdual-led-controller">IoTorero LS11PDual LED Controller</h2>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Note<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">IoTorero appears to be a sub-brand of <a href="https://www.athom.tech/" target="_blank" rel="noopener noreffer ">athom</a>; the designs are very similar.</div>
        </div>
    </div>
<p>Again, nothing to unscrew on the back; just a pry tool to open it up.
The tracks are quite wide and the extra solder implies some beefy current handling.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>This design isn&rsquo;t quite so modular or as sophisticated so it&rsquo;s easier to follow.
The individual GPIOs for the LED channels are labeled on the silkscreen but the integrated button and microphone are not so this is slightly less friendly for hacking.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<h3 id="misc-1">Misc</h3>
<h4 id="ics-and-markings-1">ICs and Markings</h4>
<p>Some of these should look familiar if you&rsquo;ve read the Gledepto teardown above:</p>
<ul>
<li><a href="https://ww1.microchip.com/downloads/en/devicedoc/8720a.pdf" target="_blank" rel="noopener noreffer "><code>SMSC 8720A</code></a>: Ethernet PHY</li>
<li><a href="https://www.lcsc.com/datasheet/C968586.pdf" target="_blank" rel="noopener noreffer "><code>CH340K</code></a>: Handles the USB to UART conversion</li>
<li><a href="https://www.alldatasheet.com/datasheet-pdf/view/485386/AOSMD/D4184.html" target="_blank" rel="noopener noreffer "><code>Alpha and Omega D4184</code></a>: N-Channel MOSFET</li>
<li><code>74HC245TA</code>, Unknown Manufacturer: Octal Bus Transceiver / level shifter</li>
</ul>
<h4 id="dmesg-1"><code>dmesg</code></h4>
<p>Nothing unusual here; I did not bother trying to check for logging output over the serial interface since WLED is already installed and there&rsquo;s no mystery firmware to reverse engineer.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>123456.526400<span class="o">]</span> usb 5-4.1.4: new full-speed USB device number <span class="m">79</span> using xhci_hcd
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.626682<span class="o">]</span> usb 5-4.1.4: New USB device found, <span class="nv">idVendor</span><span class="o">=</span>1a86, <span class="nv">idProduct</span><span class="o">=</span>7522, <span class="nv">bcdDevice</span><span class="o">=</span> 2.64
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.626688<span class="o">]</span> usb 5-4.1.4: New USB device strings: <span class="nv">Mfr</span><span class="o">=</span>0, <span class="nv">Product</span><span class="o">=</span>2, <span class="nv">SerialNumber</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.626690<span class="o">]</span> usb 5-4.1.4: Product: USB Serial
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.668754<span class="o">]</span> ch341 5-4.1.4:1.0: ch341-uart converter detected
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.682751<span class="o">]</span> usb 5-4.1.4: ch341-uart converter now attached to ttyUSB0
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="smlight-a1-slwf-09-led-controller">SMLIGHT-A1-SLWF-09 LED Controller</h2>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>And the best for last&hellip;
This one is <em>very</em> modular; you can upgrade the &ldquo;base&rdquo; model with PoE/Ethernet and a Microphone via daughterboards.</p>
<p>There are a few other &ldquo;nice touch!&rdquo; features here too:</p>
<ul>
<li>USB-C power input is a nice touch too. Shame it&rsquo;s limited to 12v. Would have been nice to see PPS used to negotiate between 12v or 20v as needed.</li>
<li>QR Codes on the silk screen and labels to help track down documentation or order parts.</li>
</ul>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Common theme: no screws on the back; just a pry tool to open it up.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>Silkscreen makes it super clear which GPIOs are used for what purpose.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            I don&#39;t know what the `AIR ADD-ON` header is for...
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Custom metal can for what is presumably an ESP32. &#39;core&#39; branding means this is likely used in most of their products.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            I guess they bought enough of these transformers that they could do customized branding...
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<h3 id="misc-2">Misc</h3>
<h4 id="ics-and-markings-2">ICs and Markings</h4>
<p>The ethernet module features the familiar <code>SMSC 8720A</code> but beyond that:</p>
<ul>
<li><a href="https://datasheet4u.com/datasheets/APM/AP90N03D/1573548" target="_blank" rel="noopener noreffer "><code>APM AP90P03D</code></a>: MOSFET for controlling power out to the LED strips.</li>
<li><a href="https://www.lcsc.com/datasheet/C2858418.pdf" target="_blank" rel="noopener noreffer "><code>WCH CH9102F</code></a>: USB to UART bridge chip.</li>
<li><a href="https://www.toll-semi.com/PDPoEICir2/214.html" target="_blank" rel="noopener noreffer "><code>Toll Semiconductor TMI7321</code></a>: PoE controller IC.</li>
</ul>
<p>I didn&rsquo;t bother lifting the metal can off of the main microcontroller but based on the other two designs here it&rsquo;s presumably an ESP32 variant (does WLED even support anything else?).
It&rsquo;s also identical in appearance to the ESP32 module used on the <a href="/slzb-mrw10/" rel="">SMLIGHT SLZB-MRW10
</a> so presumably the same module is used across multiple SMLIGHT products.</p>
<p>I didn&rsquo;t get a clear photo of the markings on the USB/PD chip either.</p>
<h4 id="dmesg-2"><code>dmesg</code></h4>
<p>Nothing unusual here; I did not bother trying to check for logging output over the serial interface since WLED is already installed and there&rsquo;s no mystery firmware to reverse engineer.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>123456.503226<span class="o">]</span> usb 5-4.1.4: new full-speed USB device number <span class="m">42</span> using xhci_hcd
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.597674<span class="o">]</span> usb 5-4.1.4: New USB device found, <span class="nv">idVendor</span><span class="o">=</span>1a86, <span class="nv">idProduct</span><span class="o">=</span>55d4, <span class="nv">bcdDevice</span><span class="o">=</span> 4.44
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.597679<span class="o">]</span> usb 5-4.1.4: New USB device strings: <span class="nv">Mfr</span><span class="o">=</span>0, <span class="nv">Product</span><span class="o">=</span>2, <span class="nv">SerialNumber</span><span class="o">=</span><span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.597682<span class="o">]</span> usb 5-4.1.4: Product: USB Single Serial
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.597684<span class="o">]</span> usb 5-4.1.4: SerialNumber: 5A&lt;...&gt;8
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.647727<span class="o">]</span> cdc_acm 5-4.1.4:1.0: ttyACM0: USB ACM device
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>#TwoMinuteTeardown: SLZB-MRW10</title><link>https://karlquinsland.com/slzb-mrw10/</link><pubDate>Fri, 26 Dec 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/slzb-mrw10/</guid><description><![CDATA[<h1 id="two-minute-teardown-smlight-slzb-mrw10">Two Minute Teardown: SMLIGHT SLZB-MRW10</h1>
<p>To make a very long story short, I need to move away from my <em>very</em> old <a href="https://en.wikipedia.org/wiki/IEEE_802.15.4" target="_blank" rel="noopener noreffer ">802.15.4</a> radios plugged into a <em>very</em> old Raspberry Pi for my smart home setup.
After some research, the <a href="https://smlight.tech/product/slzbmrw10" target="_blank" rel="noopener noreffer ">SMLIGHT SLZB-MRW10</a> is new, uses modern radios and ships with firmware that <a href="https://www.zigbee2mqtt.io/advanced/remote-adapter/connect_to_a_remote_adapter.html" target="_blank" rel="noopener noreffer ">makes it trivial to move packet processing into compute distributed on the other end of the network</a>.</p>
<p>Specifically, the <a href="https://www.silabs.com/wireless/z-wave/800-series-modem-soc" target="_blank" rel="noopener noreffer ">Silicon Labs EFR32ZG23</a> implements Z-Wave 800 (+ Long Range) and the <a href="https://www.ti.com/product/CC2674P10" target="_blank" rel="noopener noreffer ">Texas Instruments CC2674P10</a> implements Zigbee 3.0 or Thread.</p>
<p>Shame you can&rsquo;t do both Zigbee and Thread at the same time, but I&rsquo;m not in any <a href="https://news.ycombinator.com/item?id=38763743" target="_blank" rel="noopener noreffer ">hurry</a> to switch to <a href="https://en.wikipedia.org/wiki/Matter_%28standard%29" target="_blank" rel="noopener noreffer ">Matter</a> for a <a href="https://news.ycombinator.com/item?id=44508740" target="_blank" rel="noopener noreffer ">long</a> <a href="https://news.ycombinator.com/item?id=38763743" target="_blank" rel="noopener noreffer ">list</a> of <a href="https://news.ycombinator.com/item?id=44508727" target="_blank" rel="noopener noreffer ">reasons</a> so I&rsquo;ll happily stick with the Zigbee firmware.</p>
<p>The core is an ESP32 that handles the network connectivity and BT/WiFi radios.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>In the box you get the main radio unit, antennas and some misc mounting hardware / a template to help with spacing for the wall mount.
I love it when they include a template instead of just saying &ldquo;measure and drill holes yourself&rdquo;. Bonus; the QR code links to the documentation page.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>No screws so the back just snaps right off.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>SMLIGHT does have other devices that are similar form factor so I guess it makes sense to re-use the PCB and outfit it with a programming resistor.
I don&rsquo;t think this is for indicating the radio regions because I can change that in software.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            PoE circuitry.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Sorry for the glare.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<h2 id="misc">Misc</h2>
<p>Aside from the main ICs/Radios mentioned above, there are a few other interesting components:</p>
<ul>
<li><a href="https://www.ti.com/product/TMUX1574" target="_blank" rel="noopener noreffer "><code>Texas Instruments MUX1574</code></a>: not sure what this is doing here&hellip; unless it&rsquo;s managing the 6 LEDs scattered around the board? There appear to be two LEDs for each of: the ESP32, the CC2674P10, and the EFR32ZG23 which makes for a total of 6 LEDs &hellip; which is two more than the MUX1574 can handle.</li>
<li><a href="https://ww1.microchip.com/downloads/en/devicedoc/8720a.pdf" target="_blank" rel="noopener noreffer "><code>SMSC 8720A</code></a>: Ethernet PHY, same as the ones used in the <a href="/led-controllers/" rel="">LED Controllers I recently tore down</a>.</li>
<li><a href="https://www.toll-semi.com/PDPoEICir2/214.html" target="_blank" rel="noopener noreffer "><code>Toll Semiconductor TMI7321</code></a>: PoE controller IC, also used in one of the LED controllers.</li>
</ul>
<h3 id="dmesg"><code>dmesg</code></h3>
<p>The USB-C port is not just for power; as far as I can tell, it&rsquo;s wired to a <a href="https://www.silabs.com/documents/public/data-sheets/CP2102-9.pdf" target="_blank" rel="noopener noreffer ">CP210</a> which is connected to the ESP32.
Firmware on the ESP32 then proxies UART traffic from the two radios allowing you to interact with all radios over a single serial connection.</p>
<p>Interesting to see that they bothered to set the product, manufacturer, and serial number strings on the USB device instead of leaving them w/ the default values.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>176519.261646<span class="o">]</span> usb 5-4.1.4: new full-speed USB device number <span class="m">74</span> using xhci_hcd
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.370686<span class="o">]</span> usb 5-4.1.4: New USB device found, <span class="nv">idVendor</span><span class="o">=</span>10c4, <span class="nv">idProduct</span><span class="o">=</span>ea60, <span class="nv">bcdDevice</span><span class="o">=</span> 1.00
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.370691<span class="o">]</span> usb 5-4.1.4: New USB device strings: <span class="nv">Mfr</span><span class="o">=</span>1, <span class="nv">Product</span><span class="o">=</span>2, <span class="nv">SerialNumber</span><span class="o">=</span><span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.370693<span class="o">]</span> usb 5-4.1.4: Product: SMLIGHT SLZB-MRW10
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.370695<span class="o">]</span> usb 5-4.1.4: Manufacturer: SMLIGHT
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.370697<span class="o">]</span> usb 5-4.1.4: SerialNumber: 78&lt;....&gt;10
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.393095<span class="o">]</span> usbcore: registered new interface driver cp210x
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.393110<span class="o">]</span> usbserial: USB Serial support registered <span class="k">for</span> cp210x
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.393159<span class="o">]</span> cp210x 5-4.1.4:1.0: cp210x converter detected
</span></span><span class="line"><span class="cl"><span class="o">[</span>176519.400860<span class="o">]</span> usb 5-4.1.4: cp210x converter now attached to ttyUSB0
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>#TwoMinuteTeardown: Ubiquiti SFP Wizard</title><link>https://karlquinsland.com/ubiquiti-uacc-sfp-wizard/</link><pubDate>Thu, 18 Dec 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/ubiquiti-uacc-sfp-wizard/</guid><description><![CDATA[<h1 id="two-minute-teardown-ubiquiti-sfp-wizard">Two Minute Teardown: Ubiquiti SFP Wizard</h1>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>SFP modules interface to their host over what is essentially a low speed i2c interface and a few high-speed differential pairs.</p>
<p>Devices that can interrogate and re-program the SFP modules have been around for a while but they are either niche, esoteric, expensive, or all of the above.</p>
<p>People have been <a href="https://forums.servethehome.com/index.php?threads/transceiver-password-collection.39458/" target="_blank" rel="noopener noreffer ">hacking on these things</a> for a while:</p>
<ul>
<li><a href="https://forum.reveltronics.com/viewtopic.php?t=527" target="_blank" rel="noopener noreffer ">Writing protected SFP / QSFP / XFP and searching password (brute force method) - REVELTRONICS</a></li>
<li><a href="https://github.com/hfuller/transceiver-notes" target="_blank" rel="noopener noreffer ">GitHub - hfuller/transceiver-notes: Notes about hacking, programming, and otherwise dinking with SFPs and other optical transceivers.</a></li>
<li><a href="https://github.com/SloMusti/sfpddm" target="_blank" rel="noopener noreffer ">GitHub - SloMusti/sfpddm: Arduino library for interfacing SFP modules and reading DDM information as per SFF-8472</a></li>
<li><a href="https://www.hitoha.moe/read-sfp-i2c-via-ch341a-programmer" target="_blank" rel="noopener noreffer ">Read SFP I2C via CH341a Programmer – HITOHA.もえ</a></li>
<li><a href="https://osmocom.org/projects/misc-hardware/wiki/Sfp-experimenter" target="_blank" rel="noopener noreffer ">sfp-experimenter</a></li>
</ul>
<p>The <a href="https://store.ui.com/us/en/category/accessories-modules-fiber/collections/accessories-pro-direct-attach-cables/products/uacc-sfp-wizard" target="_blank" rel="noopener noreffer ">Ubiquiti SFP Wizard</a> is a new entrant to the market.</p>
<p>This is not a review.
The packaging is plain recycled (?) cardboard with white ink; it doesn&rsquo;t photograph well so this is also not an unboxing.</p>
<h2 id="teardown">Teardown</h2>
<p>This thing is a massive pain in the ass to open.
I swear, somebody on the design team must be an investor in a glue factory.</p>
<p>The device is made up of an inner frame which holds the electronics.
Two &ldquo;structural&rdquo; caps are attached to the midframe with glue ans screws.
The outer case / panels snap to this midframe and there are two decorative &ldquo;trim&rdquo; caps that complete the exterior.</p>
<p>Virtually everything has at least <em>some</em> glue on it.</p>
<p>Anyways, start with the trim cap on the SFP module side.
You will then want to begin gently trying to pry the back half of the case away from the front half.
Once the clips along the side are undone, there&rsquo;s one more clip that holds the back panel to the midframe.</p>
<p>You&rsquo;ll need a bright light and a long-neck screwdriver to hit it, but if you look through the gap between the two sfp module bays you should be able to see the tab.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>Instead of weights to make the thing feel more premium in the hand, how about a bigger battery that&rsquo;s also user-replaceable!?</p>
<p>The LCD is heat-staked into the front panel.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>Yep, it&rsquo;s an ESP32. Not expected &hellip; but welcome!</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Yep, ESP32 inside. I did not have that on my bingo card!
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>There&rsquo;s a few more interesting things on the underside of the board&hellip; including a few headers that are almost certainly for programming/debugging.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            That USB-C Port is not going anywhere!
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>That&rsquo;s about it! Once you manage to get in, it&rsquo;s a pretty simple device.</p>
<h2 id="misc">misc</h2>
<p>As soon as I saw the ESP32, I had to see if the USB-C port was connected to it (or just for power).
Yep, it&rsquo;s wired up as a USB device:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>123456.747577<span class="o">]</span> usb 5-4.1.4: new full-speed USB device number <span class="m">61</span> using xhci_hcd
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.854812<span class="o">]</span> usb 5-4.1.4: New USB device found, <span class="nv">idVendor</span><span class="o">=</span>303a, <span class="nv">idProduct</span><span class="o">=</span>1001, <span class="nv">bcdDevice</span><span class="o">=</span> 1.01
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.854818<span class="o">]</span> usb 5-4.1.4: New USB device strings: <span class="nv">Mfr</span><span class="o">=</span>1, <span class="nv">Product</span><span class="o">=</span>2, <span class="nv">SerialNumber</span><span class="o">=</span><span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.854820<span class="o">]</span> usb 5-4.1.4: Product: USB JTAG/serial debug unit
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.854822<span class="o">]</span> usb 5-4.1.4: Manufacturer: Espressif
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.854824<span class="o">]</span> usb 5-4.1.4: SerialNumber: DE:AD:BE:EF:AA:BB
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.902886<span class="o">]</span> cdc_acm 5-4.1.4:1.0: ttyACM0: USB ACM device
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.902918<span class="o">]</span> usbcore: registered new interface driver cdc_acm
</span></span><span class="line"><span class="cl"><span class="o">[</span>123456.902920<span class="o">]</span> cdc_acm: USB Abstract Control Model driver <span class="k">for</span> USB modems and ISDN adapters
</span></span></code></pre></td></tr></table>
</div>
</div><p>I wasn&rsquo;t able to use <em>just</em> <code>esptool</code> to reboot into bootloader mode and I didn&rsquo;t look for <code>boot0</code> pins so no attempt to dump the firmware was made.
If they didn&rsquo;t trigger any of the eFuse features, this thing could end up being a nice little SFP programmer for hobbyists that want to hack on SFPs beyond what the Ubiquiti stock firmware allows.</p>
<div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw" aria-hidden="true"></i>Warning<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Do not update firmware above 1.1.0. Apparently the device can <a href="https://community.ui.com/releases/SFP-Wizard-1-1-1/3249a171-c563-4fe1-91de-6b670057b541" target="_blank" rel="noopener noreffer ">no-longer flash <em>arbitrary</em>_ modules after updating</a>.</p>
<p>It&rsquo;s not clear if that&rsquo;s a mistake or they caved to some pressure from the SFP module manufacturers.</p>
</div>
        </div>
    </div>
<h3 id="other-ics">Other ICs</h3>
<ul>
<li>
<p><a href="https://www.winbond.com/hq/product/code-storage-flash-memory/serial-nor-flash/?__locale=en&amp;partNo=W25Q256JV" target="_blank" rel="noopener noreffer ">Winbond 25Q256JVFQ</a>. This is almost certainly for storing all the SFP module &ldquo;profiles&rdquo; that the device supports.</p>
</li>
<li>
<p>There&rsquo;s a TI part labeled <code>PD534 2CKG4 A49D</code> which is likely a <a href="https://www.ti.com/lit/ds/symlink/pca9534.pdf" target="_blank" rel="noopener noreffer ">PCA9534A</a> which is an IO expander. I have absolutely no idea what it&rsquo;s being used for in this design&hellip; the ESP32 has plenty of GPIOs available.</p>
</li>
</ul>
]]></description></item><item><title>#TwoMinuteTeardown: Hamgeek YK-1000H NTP</title><link>https://karlquinsland.com/hamgeek-yk-1000h-gps-ntp-server/</link><pubDate>Fri, 12 Dec 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/hamgeek-yk-1000h-gps-ntp-server/</guid><description><![CDATA[<h1 id="two-minute-teardown-hamgeek-yk-1000h-ntp">Two Minute Teardown: Hamgeek YK-1000H NTP</h1>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>Curiosity got the better of me when browsing AliExpress and I spotted <a href="https://www.aliexpress.us/item/3256808325833761.html?gatewayAdapt=glo2usa" target="_blank" rel="noopener noreffer ">this</a> GPS NTP server for under $100 USD.</p>
<p>I needed a cart-stuffer anyways so I ordered one as a backup for my <a href="/yet-another-gps-pps-opnsense/" rel="">existing</a> GPS/NTP server.</p>
<p>While waiting, I took a look around to see if there was any additional information about who makes this / if there was a custom firmware or similar.
Nope, there there is <a href="https://www.dzombak.com/blog/2024/12/yk-1000h-ntp-server/" target="_blank" rel="noopener noreffer "><em>not</em> a ton of information</a> about the <code>YK-1000H</code> online.</p>
<p>Shortly after it arrived, I plugged it in and &hellip; waited for it to get a GPS fix in an area where I know GPS works well.
After about 24 hours, still no fix!</p>
<p>That&rsquo;s when I noticed the warning that the seller had added to their product listing:</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            You&#39;ll never guess what I didn&#39;t see until after it arrived...
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>I do not really understand why there&rsquo;s a $3 surcharge for the international version; I <em>assumed</em> that all of the major GPS constellations use the same CDMA modulation in the same ~1.5GHz band so as long as you don&rsquo;t need the encrypted military signals, the radio hardware should be the same everywhere and just work everywhere.</p>
<p>Apparently not!
Oh well, the unofficial motto of AliExpress is <em>一分钱一分货</em> (&ldquo;Buyer Beware&rdquo;).</p>
<h2 id="teardown">Teardown</h2>
<p>Start from the rear, remove the screws and the nut/grommet around the SMA connector.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>You will not be able to slide the main PCB out because it&rsquo;s still connected to the front panel via a ribbon cable.</p>
<p>Then remove the front screws and then the main PCB can be slid out.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>There&rsquo;s nothing of interest on the reverse side of the main PCB or the LCD board.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>The cans on the GPS module are soldered on &hellip; but not well.
With just a little bit of prying, they came right off&hellip; to reveal a very dusty interior.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            I do not know what that dust is...
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>I can&rsquo;t get an ID on the RF front-end chip, the <a href="https://www.digikey.com/en/products/detail/macronix/MX29LV320EBTI-70G/2744812" target="_blank" rel="noopener noreffer "><code>MX-70G</code></a> next to the <code>UBX-G5000-BT</code> is almost certainly flash memory for the GPS module.
Almost none of the pads go anywhere; the two pads near that SMA connector are likely power and the other two pads that go anywhere (top left) are likely the serial TX/RX lines for configuration/debug.
It appears that the UART is broken out to that 3-pin header near the GPS module.</p>
<h2 id="ics-and-markings">ICs and Markings</h2>
<ul>
<li><a href="https://www.ixbt.com/monitor/images/aver-pilot/ubx-g5010.pdf" target="_blank" rel="noopener noreffer "><code>UBX-G5000-BT</code></a>: u-blox multi-constellation GPS receiver that absolutely should have worked anywhere in the world. Not sure why the seller insisted on the &ldquo;international&rdquo; version.</li>
<li><a href="https://www.lcsc.com/datasheet/C717616.pdf" target="_blank" rel="noopener noreffer "><code>WCH CH9126</code></a>: A dedicated SNTP client/server chip with built in ethernet MAC/PHY. Feels like a W5500 but instead of just TCP/UDP it has SNTP support built in.</li>
<li><code>74HC245KA</code>: A standard octal bus transceiver to help with data lines / level shifting.</li>
<li><a href="https://www.lcsc.com/datasheet/C91356.pdf" target="_blank" rel="noopener noreffer "><code>STC Micro STC15W4K56S4</code></a>: an 8051 based microcontroller to handle GPS parsing and general control of the device / driving the display.</li>
</ul>
<p>The main PCB has some text and a QR code in the front/left corner:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">YK-1000P 卫星同步时钟主板
</span></span><span class="line"><span class="cl">2024.11.25 Ver4.0
</span></span></code></pre></td></tr></table>
</div>
</div><p>The QR code decodes to <code>YKDZ_250505_0255</code></p>
<p>The &ldquo;carrier&rdquo; board with the CH9126 has:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">590679W_Y40_250925
</span></span></code></pre></td></tr></table>
</div>
</div><p>The LCD/Display board has a QR code that decodes to <code>YKDZ_TFT_241220_0068</code></p>
<p>Those are almost certainly production batch/date codes.
The pattern feels similar to what JLCPCB uses for their PCBs but that&rsquo;s just a guess / not uniquely identifying.</p>
<h2 id="miscellaneous">Miscellaneous</h2>
<p>I asked the seller for the software and they sent me a copy.
I do not know why they couldn&rsquo;t just have linked to it in the product listing &hellip; but oh well.
Now you can download it w/o having to bother w/ the language barrier :).</p>
<ul>
<li><a href="


https://karlquinsland.com/hamgeek-yk-1000h-gps-ntp-server/files/manual-scan.pdf


" rel="">Scanned Manual</a> (chinese and english)</li>
<li><a href="


https://karlquinsland.com/hamgeek-yk-1000h-gps-ntp-server/files/YK-1000H%E5%8D%AB%E6%98%9F%E5%90%8C%E6%AD%A5%E6%97%B6%E9%92%9F%E4%BA%A7%E5%93%81%E8%AF%B4%E6%98%8E%E4%B9%A6.pdf


" rel="">OEM Manual (<code>YK-1000H卫星同步时钟产品说明书.pdf</code>)</a> (chinese, only)</li>
<li><a href="


https://karlquinsland.com/hamgeek-yk-1000h-gps-ntp-server/files/90467%2090479%20YK-1000H%20%E8%8B%B1%E6%96%87%E8%BD%AF%E4%BB%B6.exe


" rel="">OEM Software (<code>90467 90479 YK-1000H 英文软件.exe</code>)</a></li>
</ul>
<h3 id="software">Software</h3>
<p>Partly because I didn&rsquo;t get the &ldquo;international&rdquo; version and partly because I don&rsquo;t have a proper Windows based RE environment set up, I wasn&rsquo;t able to dig into the software much.</p>
<p>Googling the very unique <code>CH9126_MODULE_V1.03</code> string turns up &hellip; <em>one</em> <a href="https://www.cnblogs.com/Lqqq123/p/18058274" target="_blank" rel="noopener noreffer ">reference</a> post with some C code that probably matches what the OEM software is doing to configure the module.</p>
<p>I have archived the reference post <a href="https://web.archive.org/save/https://www.cnblogs.com/Lqqq123/p/18058274" target="_blank" rel="noopener noreffer ">here</a> and <a href="


https://karlquinsland.com/hamgeek-yk-1000h-gps-ntp-server/files/random-reference-code.pdf


" rel="">here</a>.
That reference post has a link to a <a href="


https://karlquinsland.com/hamgeek-yk-1000h-gps-ntp-server/files/CH9126ConfigTool.zip


" rel=""><code>CH9126ConfigTool.zip</code></a> which appears to be a reference implementation/SDK with a compiled <code>.exe</code> as well.
The <code>.exe</code> isn&rsquo;t the same one as what the seller sent me &hellip; but the icon is identical so they&rsquo;re probably from the same source.</p>
<p>The <code>strings</code> output did raise an eyebrow:</p>
<ul>
<li>The common UART baud rate strings is interesting, probably for configuring the comms to the main microcontroller.</li>
<li>No obvious certificates or cryptographic strings; firmware might not be signed?</li>
<li>There is some mechanism for saving configuration. Presumably that&rsquo;s a cheap way to load arbitrary bytes into the device&hellip; :)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">❯ strings 90467<span class="se">\ </span>90479<span class="se">\ </span>YK-1000H<span class="se">\ </span>英文软件.exe
</span></span><span class="line"><span class="cl">SNTP CHANNEL
</span></span><span class="line"><span class="cl">SNTP
</span></span><span class="line"><span class="cl">Space
</span></span><span class="line"><span class="cl">Mark
</span></span><span class="line"><span class="cl">Even
</span></span><span class="line"><span class="cl">None
</span></span><span class="line"><span class="cl">Operation Status:
</span></span><span class="line"><span class="cl"><span class="o">(</span>&lt;<span class="o">=</span>1024<span class="o">)</span>
</span></span><span class="line"><span class="cl">Data Format:
</span></span><span class="line"><span class="cl">Rx Pack TimeOut:
</span></span><span class="line"><span class="cl">Rx Pack Len:
</span></span><span class="line"><span class="cl">Parity:
</span></span><span class="line"><span class="cl">Stop Bit:
</span></span><span class="line"><span class="cl">Data Bit:
</span></span><span class="line"><span class="cl">Baud:
</span></span><span class="line"><span class="cl">PORT CONFIG
</span></span><span class="line"><span class="cl">GateWay:
</span></span><span class="line"><span class="cl">Mask:
</span></span><span class="line"><span class="cl">Name:
</span></span><span class="line"><span class="cl">NET CONFIG
</span></span><span class="line"><span class="cl">SAVE CONFIG
</span></span><span class="line"><span class="cl">LOAD CONFIG
</span></span><span class="line"><span class="cl">CONFIG
</span></span><span class="line"><span class="cl">RESET
</span></span><span class="line"><span class="cl">SEARCH
</span></span><span class="line"><span class="cl">Module List<span class="o">(</span>Double Click to get configuration<span class="o">)</span>
</span></span><span class="line"><span class="cl">REFRESH
</span></span><span class="line"><span class="cl">Adapter:
</span></span><span class="line"><span class="cl">Name
</span></span><span class="line"><span class="cl">Operation Status:
</span></span><span class="line"><span class="cl">%d.%s
</span></span><span class="line"><span class="cl"><span class="nb">bind</span> error : %d
</span></span><span class="line"><span class="cl">ip:%s  mac: %02X:%02X:%02X:%02X:%02X:%02X
</span></span><span class="line"><span class="cl">socket error : %d
</span></span><span class="line"><span class="cl">Config Successful!
</span></span><span class="line"><span class="cl">Reset Successful!
</span></span><span class="line"><span class="cl">Successfully Get Configuration On Line %d
</span></span><span class="line"><span class="cl">Search Device Successful!
</span></span><span class="line"><span class="cl">CH9126_MODULE_V1.03
</span></span><span class="line"><span class="cl">recvfrom error : %d
</span></span><span class="line"><span class="cl">Receive Failed...
</span></span><span class="line"><span class="cl">sendto error : %d
</span></span><span class="line"><span class="cl">&lt;...&gt;
</span></span><span class="line"><span class="cl">Searching Devices...
</span></span><span class="line"><span class="cl">Create Socket Failed, Please Retry...
</span></span><span class="line"><span class="cl">Please Choose One Module From Module List,If There Is None,Please Search First
</span></span><span class="line"><span class="cl">No Valid Rows Selected...
</span></span><span class="line"><span class="cl">Getting Device Configuration...
</span></span><span class="line"><span class="cl">The Length Of The Module Name Is Illegal,Please Retry...
</span></span><span class="line"><span class="cl">Rx Pack Len is between <span class="m">0</span> and 1024!Please Re-enter...
</span></span><span class="line"><span class="cl"><span class="m">1024</span>
</span></span><span class="line"><span class="cl">Configuring...
</span></span><span class="line"><span class="cl">Save Configuration Successful!
</span></span><span class="line"><span class="cl">%s.cfg
</span></span><span class="line"><span class="cl">saved
</span></span><span class="line"><span class="cl">CFG Files <span class="o">(</span>*.cfg<span class="o">)</span><span class="p">|</span>*.cfg<span class="o">||</span>
</span></span><span class="line"><span class="cl">Load Successful!
</span></span><span class="line"><span class="cl">saved.cfg
</span></span><span class="line"><span class="cl">CFG Files <span class="o">(</span>*.cfg<span class="o">)</span><span class="p">|</span>*.cfg<span class="p">|</span>
</span></span><span class="line"><span class="cl">open
</span></span><span class="line"><span class="cl">.<span class="se">\H</span>elp.txt
</span></span><span class="line"><span class="cl">Pulse Output:
</span></span><span class="line"><span class="cl">Polling Interval:
</span></span><span class="line"><span class="cl">Dest IP:
</span></span><span class="line"><span class="cl">Mode:
</span></span><span class="line"><span class="cl">Random
</span></span><span class="line"><span class="cl">Local Port:
</span></span><span class="line"><span class="cl">Dest Prot:
</span></span><span class="line"><span class="cl">&lt;...&gt;
</span></span><span class="line"><span class="cl"><span class="m">1200</span>
</span></span><span class="line"><span class="cl"><span class="m">2400</span>
</span></span><span class="line"><span class="cl"><span class="m">4800</span>
</span></span><span class="line"><span class="cl"><span class="m">9600</span>
</span></span><span class="line"><span class="cl"><span class="m">14400</span>
</span></span><span class="line"><span class="cl"><span class="m">19200</span>
</span></span><span class="line"><span class="cl"><span class="m">38400</span>
</span></span><span class="line"><span class="cl"><span class="m">57600</span>
</span></span><span class="line"><span class="cl"><span class="m">115200</span>
</span></span><span class="line"><span class="cl"><span class="m">230400</span>
</span></span><span class="line"><span class="cl"><span class="m">460800</span>
</span></span><span class="line"><span class="cl"><span class="m">921600</span>
</span></span><span class="line"><span class="cl">Mark
</span></span><span class="line"><span class="cl">Space
</span></span><span class="line"><span class="cl">ASCII
</span></span><span class="line"><span class="cl">TCP_Sever
</span></span><span class="line"><span class="cl">TCP_Client
</span></span><span class="line"><span class="cl">UDP_Server
</span></span><span class="line"><span class="cl">UDP_Client
</span></span><span class="line"><span class="cl">KeepSocket
</span></span><span class="line"><span class="cl">DiscardSocket
</span></span><span class="line"><span class="cl">StoreAllData
</span></span><span class="line"><span class="cl">StoreLastData
</span></span><span class="line"><span class="cl">StoreNoData
</span></span><span class="line"><span class="cl">SNTP_Server
</span></span><span class="line"><span class="cl">SNTP_Client
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>#TwoMinuteTeardown: Duogalia AM70 Optical Fiber Multi-Meter</title><link>https://karlquinsland.com/duogalia-am70-optical-fiber-multi-meter/</link><pubDate>Wed, 10 Dec 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/duogalia-am70-optical-fiber-multi-meter/</guid><description><![CDATA[<h1 id="two-minute-teardown-duogalia-a-m70-optical-fiber-multi-meter">Two Minute Teardown: Duogalia A-M70 Optical Fiber Multi-Meter</h1>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>While diagnosing a flakey fiber link, i ran into a situation where a basic &ldquo;flashing red&rdquo; visual fault finder was not sufficient.
I needed to actually measure the optical power levels on both ends of the link to ensure that the fiber was not damaged and that the SFPs were operating within spec.</p>
<p><a href="https://www.amazon.com/dp/B0B6TY7X6K" target="_blank" rel="noopener noreffer ">This</a> was the cheapest tool that could be delivered quickly.
The issue was found and fixed so now let&rsquo;s have a look inside.</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Many Generics<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>There are many many similar looking units on Ali Express and the other usual import sites.
I do not know who the ODM is but it&rsquo;s clear that the <code>Duogalia A-M70</code> is just another rebrand of the same design.</p>
<p>As best as I can tell, the ODM for this is <code>T-Better</code>?</p>
</div>
        </div>
    </div>
<h2 id="teardown">Teardown</h2>
<p>The nice thing about simple devices like this is that they are easy to open and rather predictable inside.
From the back, there are four self-tapping screws holding the back panel on.
Removing those reveals a very simple interior.</p>
<p>The few unpopulated components near where the battery attaches are almost certainly for a &ldquo;better&rdquo; model that has a built in battery that can be recharged over the non populated USB-C port.</p>
<p>The square IC in the middle is running the show, the large IC off to the side is likely the display driver and the two SOP-16 chips near the ethernet port and optical sensors are for abstracting the details away for the benefit of the microcontroller.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>There are 4 more screws holding the PCB to the front half of the case; if you remove them, you can get a look at the side of the PCB with the screen on it&hellip; revealing that there&rsquo;s absolutely nothing special on the other side of the PCB.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>And here&rsquo;s a close up of the silk screen on the main controller that makes me think <code>T-Better</code> is the ODM.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<h2 id="miscellaneous">Miscellaneous</h2>
<p>The PCB is marked with:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">T-Better
</span></span><span class="line"><span class="cl">MINI-OPM-N32-MAIN
</span></span><span class="line"><span class="cl">V11 20250617
</span></span></code></pre></td></tr></table>
</div>
</div><p>The main ICs are:</p>
<ul>
<li>
<p><a href="https://uploadcdn.oneyac.com/attachments/files/brand_pdf/hgsemi/2B/E2/CD4017CMTR.pdf" target="_blank" rel="noopener noreffer "><code>HGSemi / CD4017C</code></a>: a 10 bit decade counter to handle the ethernet cable testing functions.</p>
</li>
<li>
<p><a href="https://www.nationstech.com/uploadfile/file/20220907/1662539811646982.pdf" target="_blank" rel="noopener noreffer "><code>NSING / NATION N32G031</code></a>:  Cortex®-M0 microcontroller running the show.</p>
</li>
<li>
<p><a href="https://www.lcsc.com/datasheet/C507163.pdf" target="_blank" rel="noopener noreffer "><code>HGSemi / CD4051B</code></a>: an 8-channel analog multiplexer to handle the optical power sensor inputs. I guess the main microcontroller doesn&rsquo;t have enough ADC channels on its own.</p>
</li>
<li>
<p><a href="https://www.lcsc.com/datasheet/C5174490.pdf" target="_blank" rel="noopener noreffer "><code>TM(Shenzhen Titan Micro Elec) TM1621B / TM1621B</code></a>: the LCD driver IC for the display.</p>
</li>
</ul>
<p>I was not able to locate the OEM or get a digital copy of the manual that came with this thing so I scanned it myself. You can fetch it <a href="


https://karlquinsland.com/duogalia-am70-optical-fiber-multi-meter/files/manual-scan.pdf


" rel="">here</a>.</p>
]]></description></item><item><title>TESmart HKS801-P23-USBK KVM Teardown</title><link>https://karlquinsland.com/tesmart-hks801-p23-usbk-kvm-teardown/</link><pubDate>Sat, 17 May 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/tesmart-hks801-p23-usbk-kvm-teardown/</guid><description><![CDATA[<h1 id="tesmart-hks801-p23-usbk-kvm-teardown">TESmart HKS801-P23-USBK KVM Teardown</h1>
<p>Recently, one of the USB ports on <a href="/hdmi-kvm-teardown-and-esphome/" rel="">my previous KVM switch</a> failed. Since it&rsquo;s a critical piece of equipment, I needed a replacement the same day. The original AliExpress product page was no longer available; the seller seems to have closed up shop entirely.</p>
<p>Fortunately, the OEM—<code>XUFUNG</code>—has released an updated version, now sold in the US as the <a href="https://www.tesmart.com/products/hks801-p23" target="_blank" rel="noopener noreffer ">TESmart HKS801-P23-USBK</a>. It looks visually identical to the previous KVM switch, but the USB ports now feature the characteristic blue color indicating USB 3.0 support.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            OEM &#39;what&#39;s in the box&#39; image.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            OEM feature overview image.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            OEM &#34;what&#39;s new&#34; image; the big upgrade here is 5 Gbps USB support.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Note<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Despite every PCB featuring a clear <code>XUFUNG</code> label, that specific string doesn&rsquo;t appear in many places online! A quick Google search only returns my prior post and <a href="https://dancharblog.wordpress.com/2025/05/02/tesmart-hdc202-x24-thunderbolt-4-kvm-teardown-and-review/" target="_blank" rel="noopener noreffer ">this teardown of another TESmart KVM</a>. You should check out the internals of that one too! Because it uses Thunderbolt, the internals are quite a bit more complicated.</div>
        </div>
    </div>
<h2 id="whats-inside">What&rsquo;s inside?</h2>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>TL;DR<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">It&rsquo;s the same architecture as before, but with some minor component changes and corresponding PCB layout updates.</div>
        </div>
    </div>
<p>As before, two main PCBs are stacked: the top houses the main microcontroller and HDMI ports, while the bottom contains the USB ports and power supply.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Photo taken just after top cover removed.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p><figure >

    
        
        

    

    <figcaption>
        
        <p>
            Close up of the &#34;output&#34; portion of the HDMI PCB.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Closeup of the network interface PCB.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Angled shot of the dupont connector between the top (HDMI) and bottom (USB) PCBs.
            
                
                
        </p> 
    </figcaption>
    
</figure>

</p>
<p>It&rsquo;s interesting to see that the power rails differ: 5V for the 4K version, and apparently there&rsquo;s an 8K version that uses 12V. It&rsquo;s also nice that the RX/TX lines are explicitly labeled; it makes things a bit easier to hack on.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Close up of the RTS5411S USB hub controller and the mysterious F68B chips.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<h2 id="chips">Chips</h2>
<p>In no particular order, here are the main ICs I identified on the PCB:</p>
<ul>
<li>
<p><a href="https://lcsc.com/product-detail/USB-Converters_Realtek-Semicon-RTS5411S-GR_C5356838.html" target="_blank" rel="noopener noreffer ">RTS5411s</a> - USB 3.1 Super-Speed HUB Controller
cx32l003f8</p>
</li>
<li>
<p>F68B / A1V8 - Not sure, can&rsquo;t find any positive ID. There&rsquo;s one for every RTS5411S port, though, and some traces do daisy chain between the individual F68B chips so i&rsquo;m guessing they&rsquo;re related to USB and possibly a buffer/signal conditioner?</p>
<ul>
<li>Interestingly enough, I don&rsquo;t see any traces from this chip to the &ldquo;slow&rdquo; USB ports that are meant to handle the keyboard/mouse. Those are monitored by the CH545L which is probably looking for the keyboard/mouse signals to trigger switching between banks.</li>
</ul>
</li>
<li>
<p><a href="https://lcsc.com/product-detail/Microcontrollers-MCU-MPU-SOC_WCH-Jiangsu-Qin-Heng-CH545L_C19183926.html?s_z=n_C19183926" target="_blank" rel="noopener noreffer ">WCH CH545L</a> - USB multi-host multi-device enhanced E8051 MCU</p>
</li>
<li>
<p><a href="https://www.zbitsemi.com/upload/file/20200903/20200903105452_99571.pdf" target="_blank" rel="noopener noreffer ">CX32L003F8</a> - ARM® Cortex®-M0+ 32-bit</p>
<ul>
<li>Used in a few different locations: front panel to scan buttons, update the display, monitor IR signals.</li>
</ul>
</li>
<li>
<p><a href="https://www.wch-ic.com/products/CH578_7.html" target="_blank" rel="noopener noreffer ">WCH CH578M</a> - ARM® Cortex®-M0 Core Bluetooth Low Energy MCU</p>
<ul>
<li>This is the micro on the LAN port; makes sense as it has a built in 10M Ethernet PHY</li>
<li>Assuming there&rsquo;s no restriction that prevents the ethernet PHY and BT PHY from being used at the same time, this KVM could have ditched the IR remote and used a phone app instead&hellip;</li>
<li>Previously, this was handled with a <a href="https://www.st.com/en/microcontrollers-microprocessors/stm8s003f3.html" target="_blank" rel="noopener noreffer ">ST 8S003f3p6</a> and a <a href="https://jlcpcb.com/partdetail/WCH_Jiangsu_Qin_Heng-CH395Q/C87390" target="_blank" rel="noopener noreffer ">WCH CH395Q</a> so the LAN controller has definitely had a BOM consolidation!</li>
</ul>
</li>
<li>
<p><a href="https://en.chipsea.com/product/details/?choice_id=1079" target="_blank" rel="noopener noreffer ">Chipsea CS32F031C8T6</a> - ARM® Cortex®-M0 MCU</p>
<ul>
<li>Happens to be the exact same micro as the previous KVM and seems to be featured in Dan&rsquo;s KVM, too</li>
</ul>
</li>
<li>
<p><a href="https://jlcpcb.com/partdetail/GEC-WS3232ECN/C2973151" target="_blank" rel="noopener noreffer ">WS3232ECN</a> - Generic RS232 transceiver</p>
<ul>
<li>Previously this was done with a <code>SIPEX SP3223EEX</code> which is not the same footprint as the WS3232ECN.. so that&rsquo;s a minor layout change</li>
</ul>
</li>
<li>
<p><a href="https://web.archive.org/web/20240523025020/https://www.ite.com.tw/en/product/view?mid=99" target="_blank" rel="noopener noreffer ">IT66341TE</a> - 4 IN to 1 OUT HDMI2.0 18Gb/s Switch.</p>
<ul>
<li>Still can&rsquo;t find any formal technical info on this chip, probably due to <a href="https://en.wikipedia.org/wiki/High-bandwidth_Digital_Content_Protection" target="_blank" rel="noopener noreffer ">HDCP</a> restrictions.</li>
<li>Same as the previous KVM, but that one also used an IT66321E, which is not present on this PCB.</li>
</ul>
</li>
</ul>
]]></description></item><item><title>#TwoMinuteTeardown: Petkit Eversweet Solo 2</title><link>https://karlquinsland.com/petkit-eversweet-solo2-teardown/</link><pubDate>Sun, 20 Apr 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/petkit-eversweet-solo2-teardown/</guid><description><![CDATA[<h1 id="two-minute-teardown-petkit-eversweet-solo-2">Two Minute Teardown: Petkit Eversweet Solo 2</h1>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>I am doing research for an upcoming project and was curious about how other people have solved a similar problem.
<a href="https://www.amazon.com/dp/B0B3RWF653" target="_blank" rel="noopener noreffer ">This</a> happens to be the cheapest option that was available at the time.</p>
<p>I am primarily interested in the pump; the integrated &ldquo;low water&rdquo; sensor and the UV-C sterilization are very nice features that would check off a lot of boxes for me&hellip; Unfortunately this pump it lacks both the flow rate and the head that I need for my project.</p>
<p>Oh well.</p>
<p>The pump is sealed with a potting compound so I was not able to do a full teardown.</p>
<p><figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            The black protrusion is the water level sensor.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>

</p>
<p>The base isn&rsquo;t that spectacular; a cheap micro with BTLE controlling power to a basic wireless power transmission module.
The wireless power module is covered in conformal coating so the IC number was a pain to read but it is a XKT-511.
I can find <a href="https://leap.tardate.com/electronics101/power/wirelessledmodule/" target="_blank" rel="noopener noreffer "><em>very</em> little information</a> about this IC.
As far as I can tell, it is similar to Qi wireless power but without any signaling or modulation of the carrier signal.
Various qi receiver devices will briefly &ldquo;wake up&rdquo; when placed on the base but they do not stay powered on or charge.
My <a href="/wozniak-wpx-0001a-qi-tester-teardown/" rel="">qi tester</a> does power up and measures about .2W but it can&rsquo;t recognize the protocol.</p>
<p><figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>

</p>
]]></description></item><item><title>#TwoMinuteTeardown: Wozniak WPX-0001 Qi Tester</title><link>https://karlquinsland.com/wozniak-wpx-0001a-qi-tester-teardown/</link><pubDate>Sun, 20 Apr 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/wozniak-wpx-0001a-qi-tester-teardown/</guid><description><![CDATA[<h1 id="qi-wireless-power-tester">Qi wireless power tester</h1>
<p>The <a href="https://en.wikipedia.org/wiki/Qi_%28standard%29" target="_blank" rel="noopener noreffer ">Qi standard</a> for transmitting power is ~ 15 years old and has been ubiquitous for at least a decade now.
And yet, I have only <em>recently</em> seen any testing equipment for it.</p>
<p>The <a href="https://www.aliexpress.us/item/3256808097182455.html" target="_blank" rel="noopener noreffer ">Wozniak WPX-0001A</a> is a simple tester that can measure the output level and protocol of Qi chargers.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            &#39;standard tools create wonderful things&#39; ❤️.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Please ignore the super shiny reflections...
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>In the box you get a basic NTC probe, a USB-C cable and the tester itself.
The printed paper &ldquo;manual&rdquo; is just a QR code that points to <a href="https://user.ee-lab.cn" target="_blank" rel="noopener noreffer "><code>user.ee-lab.cn</code></a>.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Yep, more reflections/glare. Sorry!
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>The unit is made up of two circular PCBs screwed together.
The screws are hiding behind the decal face plate.</p>
<p>Take your time here and use a heat gun to soften the adhesive&hellip; or you risk breaking the plastic cover.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Three of the four screws can be seen here. The remaining screw is hiding beneath the remaining decal shard.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<p>The LCD is also glued in place. The ribbon cable is <em>just</em> long enough; putting it back together is a bit of a pain.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>The non-covered gold-plated traces and black silkscreen <em>pop</em>.
Unfortunately, most ICs are either too small for me to read or the marking have been laser etched off.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>The business-end of the tester is a Qi receiver coil.
It&rsquo;s two coils of magnet wire and some magnets. Nothing special here.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        <p>
            The snaking black cable is the NTC probe.
            
                
                
        </p> 
    </figcaption>
    
</figure>


]]></description></item><item><title>#TwoMinuteTeardown: Panel Mount Liquid Level Indicator</title><link>https://karlquinsland.com/generic-liquid-level-display/</link><pubDate>Sat, 15 Feb 2025 00:00:00 +0000</pubDate><author>karl</author><guid>https://karlquinsland.com/generic-liquid-level-display/</guid><description><![CDATA[<h1 id="generic-liquid-level-meter-teardown">Generic liquid level meter teardown</h1>
<p>I ordered this part years ago for a project I eventually canceled.</p>
<p>I can&rsquo;t use it for anything, and it&rsquo;s just taking up space, so I&rsquo;m going to open it up before I recycle it.</p>
<p>The Ali Express listing is a 404 so I don&rsquo;t have a link to share or really any information about it.</p>
<p>The main thing to take away is that it&rsquo;s meant to interface with a liquid level sensor.
It will display the level of liquid in a tank and - optionally - trigger a few relays based on the level.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>This is a generic case; not all screw terminals pictured here are actually wired up to anything on this model.</p>
<figure >

    
        
        

    

    <figcaption>
        
        <p>
            Not all the screw terminals are actually wired up to anything on this model; the case is generic.
            
                
                
        </p> 
    </figcaption>
    
</figure>


<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>The main body slides off pretty easily.
There are two PCBs inside: one for the display and one to handle the relays and sensor input.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>The display PCB is pretty simple; no active electronics and a tonne of LEDs.
The bar graph LEDs are almost certainly <a href="https://en.wikipedia.org/wiki/Charlieplexing" target="_blank" rel="noopener noreffer ">charlieplexed</a> but the 7 segment might have an integrated driver.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>The screw terminals on the rear of the case are directly soldered to the main PCB so I&rsquo;m not going to be able to take it apart any further without disordering things&hellip; defeating the spirit of the <a href="/tags/two-minute-teardown/" rel="">#TwoMinuteTeardown</a>.</p>
<figure >

    
        
        

    

    <figcaption>
        
        
    </figcaption>
    
</figure>


<p>Looking at the top left, you can see the few pins for the 7-segment displays; a total of 12 pins.
Of those 12, some don&rsquo;t have traces leading to them so they&rsquo;re probably just for mechanical support. There are far too few remaining pins for even basic charlieplexing so I&rsquo;m guessing there&rsquo;s an integrated driver of some kind. Probably a <a href="https://www.analog.com/media/en/technical-documentation/data-sheets/max7219-max7221.pdf" target="_blank" rel="noopener noreffer ">max7219</a> or similar</p>
<h2 id="the-main-ics">The main ICs</h2>
<p>Really just the one main application processor and a few support ICs.</p>
<ul>
<li><a href="https://www.jotrin.com/product/parts/MA803AS2" target="_blank" rel="noopener noreffer "><code>MA803AS2</code></a> - 8051 based microcontroller that&rsquo;s running the show</li>
<li><a href="https://www.alldatasheet.com/datasheet-pdf/pdf/1679343/NEXPERIA/HEF4051B.html" target="_blank" rel="noopener noreffer "><code>HEF4051B</code></a> - 8-channel analog multiplexer, probably for the display</li>
<li><code>74hc164</code> - 8-bit shift register, probably for the display</li>
</ul>
]]></description></item></channel></rss>