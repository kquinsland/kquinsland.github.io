<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=X-UA-Compatible content="IE=edge, chrome=1"><title>ESPHome on the Yeelight Monitor Light Bar Pro - karl</title><meta name=Description content="Quick look at the internals of YLTD003 and ESPHome config"><meta property="og:title" content="ESPHome on the Yeelight Monitor Light Bar Pro">
<meta property="og:description" content="Quick look at the internals of YLTD003 and ESPHome config"><meta property="og:type" content="article"><meta property="og:url" content="https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/"><meta property="og:image" content="https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/marketing-photo.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-21T16:20:30-07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/marketing-photo.webp"><meta name=twitter:title content="ESPHome on the Yeelight Monitor Light Bar Pro"><meta name=twitter:description content="Quick look at the internals of YLTD003 and ESPHome config"><meta name=twitter:site content="@somerandomguy"><meta name=application-name content="karl"><meta name=apple-mobile-web-app-title content="karl"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=https://karlquinsland.com/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://karlquinsland.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://karlquinsland.com/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://karlquinsland.com/apple-touch-icon.png><link rel=mask-icon href=https://karlquinsland.com/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=https://karlquinsland.com/site.webmanifest><link rel=canonical href=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/><link rel=prev href=https://karlquinsland.com/solum-el022hwra-teardown/><link rel=next href=https://karlquinsland.com/sonoff-t5-esphome/><link rel=stylesheet href=https://karlquinsland.com/lib/normalize/normalize.min.055364f5be272caa092b0e6654c165828707f8ab971e2656383a6d6392bc345e.css integrity="sha256-BVNk9b4nLKoJKw5mVMFlgocH+KuXHiZWODptY5K8NF4="><link rel=stylesheet href=https://karlquinsland.com/css/style.min.1e2694bed152fa2922dbe909a441838ed693d88b1330f97485bfa8ed78da42df.css integrity="sha256-HiaUvtFS+iki2+kJpEGDjtaT2IsTMPl0hb+o7XjaQt8="><link rel=stylesheet href=https://karlquinsland.com/lib/fontawesome-free/all.min.876d023d9d10c97941b80c3b03e2a5b94631ff7a4af9cee5604a6a2d39718d84.css integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ="><link rel=stylesheet href=https://karlquinsland.com/lib/animate/animate.min.3c770e90f98eb21b0c042fafb49755af93306fbaf42e449524f94fae9fc83295.css integrity="sha256-PHcOkPmOshsMBC+vtJdVr5Mwb7r0LkSVJPlPrp/IMpU="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ESPHome on the Yeelight Monitor Light Bar Pro","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/karlquinsland.com\/yeelight-monitor-lamp-teardown-esphome\/"},"genre":"posts","keywords":"esphome, home assistant","wordcount":1606,"url":"https:\/\/karlquinsland.com\/yeelight-monitor-lamp-teardown-esphome\/","datePublished":"2023-09-18T00:00:00+00:00","dateModified":"2023-09-21T16:20:30-07:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"karl"},"description":"Quick look at the internals of YLTD003 and ESPHome config"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=https://karlquinsland.com/ title=karl>Karl</a></div><div class=menu><div class=menu-inner><a class=menu-item href=https://karlquinsland.com/posts/><i class="fas fa-blog"></i> Posts </a><a class=menu-item href=https://karlquinsland.com/resume/ title="Hire Me!"><i class="fas fa-briefcase"></i> Résumé </a><a class=menu-item href=https://karlquinsland.com/tags/ title="Can you tell that I don't have a super consistent or clear taxonomy?"><i class="fas fa-tags"></i> Tags </a><a class=menu-item href=https://karlquinsland.com/contact/><i class="fas fa-address-book"></i> Contact </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=https://karlquinsland.com/ title=karl>Karl</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=https://karlquinsland.com/posts/ title><i class="fas fa-blog"></i>Posts</a><a class=menu-item href=https://karlquinsland.com/resume/ title="Hire Me!"><i class="fas fa-briefcase"></i>Résumé</a><a class=menu-item href=https://karlquinsland.com/tags/ title="Can you tell that I don't have a super consistent or clear taxonomy?"><i class="fas fa-tags"></i>Tags</a><a class=menu-item href=https://karlquinsland.com/contact/ title><i class="fas fa-address-book"></i>Contact</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">ESPHome on the Yeelight Monitor Light Bar Pro</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://karlquinsland.com/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>karl</a></span>&nbsp;<span class=post-category>included in <a href=https://karlquinsland.com/categories/teardown/><i class="far fa-folder fa-fw"></i>teardown</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2023-09-18>2023-09-18</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1606 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;8 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#yeelight-light-bar-pro-yltd003-teardown>Yeelight Light Bar Pro (YLTD003) Teardown</a><ul><li><a href=#unbox>Unbox</a></li><li><a href=#teardown>Teardown</a></li><li><a href=#esp32-retrofit>ESP32 Retrofit</a><ul><li><a href=#esphome>ESPHome</a></li></ul></li><li><a href=#pcbic-markings>PCB/IC markings</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=yeelight-light-bar-pro-yltd003-teardown>Yeelight Light Bar Pro (YLTD003) Teardown</h1><p>Monitor-top light bars are wonderful for reducing eye strain and fatigue and the effect is even better with a bias light behind the monitor.
Enter the <a href=https://www.aliexpress.us/item/3256801709519092.html target=_blank rel="noopener noreffer">Yeelight Light Bar Pro (YLTD003)</a>.</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/marketing-photo.webp alt="YeeLight marketing photo from AliExpress listing. The background wash light really does help reduce eye strain and fatigue."><figcaption><p>YeeLight marketing photo from AliExpress listing. The background wash light really does help reduce eye strain and fatigue.</p></figcaption></figure><p>It appears to be a pretty straightforward clone of the Xaomi MJGJD02YL that I&rsquo;ve torn down <a href=https://karlquinsland.com/xaomi-s1-monitor-lamp-teardown-and-tasmota/ rel>previously</a> but with some welcome changes internally.</p><h2 id=unbox>Unbox</h2><p>Before teardown, quick look at the box.
The shipping damage is just part of the Ali Express experience!</p><p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/unbox-front.jpg alt="Picture showing the front of the product box."><figcaption><p>The box isn't anything to write home about.</p></figcaption></figure><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/unbox-open.jpg alt="Picture showing internals of the opened box."><figcaption><p>Neatly packed, for what it's worth.</p></figcaption></figure><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/unbox-rear.jpg alt="Picture showing the rear of the product box."><figcaption></figcaption></figure></p><p>Not only does it look a lot like the Xaomi lamp, it&rsquo;s dimensionally similar, too.
It&rsquo;s 100% compatible with the mounting bracket that Xaomi shipped with their lamp.</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/xaomi-size-comparison.jpg alt="Picture showing the Yee light bar next to the Xaomi light bar. The Yeelight is slightly longer and has a larger end cap on the left."><figcaption><p>Xaomi desk lamp on top, Yeelight on bottom.</p></figcaption></figure><h2 id=teardown>Teardown</h2><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Tip<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content><p>I am going to run through a <em>complete</em> teardown.</p><p>You do not need to <strong>completely</strong> disassemble the lamp to replace the ESP8266 with an ESP32.</p><p>To access the ESP8266 based module controlling the lamp, you really only need to remove the larger of the two end caps.
From there, you will have a few inches of ribbon cable to work with. If you&rsquo;re careful, you can replace the ESP8266 with an ESP32 without removing the main PCB from the tube but you may find that taking the main PCB out of the tube makes it easier to work with.</p></div></div></div><p>Just like with the Xaomi lamp, you will start by removing the sticker covering the small metal protrusion that holds the pogo pins and mates with the power supply &ldquo;dock&rdquo;.
The pogo pins are one of the two features that keep the main PCB from sliding out of the tube.</p><p>Discard the sicker and put the metal piece and the pogo pin assembly somewhere safe.
This step is not pictured.</p><p>Next, note that Yeelight bar has a larger plastic cap on the left relative to the one on the right.
Not only does this cap have a grip feature moulded in, it&rsquo;s also secured to the tube with a lot less glue than the Xaomi lamp; just grip and twist to remove this cap.</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-endcap.jpg alt="Picture showing a close up of the Yee light bar end cap."><figcaption><p>The cap is trivial to remove.</p></figcaption></figure><p>After the end cap is removed, you will be able to see inside the tube.
There&rsquo;s not much room, but the micro controller is on it&rsquo;s own little PCB attached to the main PCB with ~50mm of ribbon cable.
If you&rsquo;re careful, this is all the disassembly you need to do to access the ESP8266 module.</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-tube-interior.jpg alt="Picture showing the interior of the tube after removing the end cap"><figcaption><p>There's not much room to work with. Left most is the cw/ww led strip and reflector. Middle is ribbon cable connecting leds to main pcb. Right most is the ESP8266 module.</p></figcaption></figure><p>As of writing, I could not find any information about which pins on the module are used for programming.
I was under a bit of time pressure and wanted to use a more &ldquo;future proof&rdquo; ESP32 module anyways so I didn&rsquo;t bother trying to program the ESP8266 module.</p><p>I opted to replace it with an ESP32 module that I had on hand.</p><p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-oem-esp-closeup-front.jpg alt="Picture showing closeup of the ESP8266 module that shipped with the lamp"><figcaption><p>It's clearly an ESP8266 module but the pinout/form-factor are unusual.</p></figcaption></figure><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-oem-esp-closeup-rear.jpg alt="Picture showing closeup of the ESP8266 module that shipped with the lamp"><figcaption></figcaption></figure></p><p>If you want to extract the main PCB from the tube, you will notice that there&rsquo;s still <em>something</em> holding it in place.
That something is the plastic lens closest to the now removed end cap.</p><p>Using a small flat pry tool or razor blade, you can carefully pry the lens out of the tube.</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-main-pcb-slid-out.jpg alt="Picture showing final disassembly step of the Yee light bar."><figcaption><p>Note the plastic lense that used to cover the RGB LEDs.</p></figcaption></figure><p>With the plastic lense out of the way, the main PCB and the cw/ww light ribbon and reflector can be slid out of the tube.</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-complete.jpg alt="There's not much to it, really. Tube, big PCB and small ESP8266 module on a ribbon cable."><figcaption><p>There's not much to it, really. Tube, big PCB and small ESP8266 module on a ribbon cable.</p></figcaption></figure><p>That&rsquo;s really all there is to opening up the lamp.</p><p>Below a few more photos of the internals.</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-pcb-2.jpg alt="A look at the power regulation and LED drive circuitry."><figcaption><p>A look at the power regulation and LED drive circuitry.</p></figcaption></figure><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-pcb-3.jpg alt="Picture showing"><figcaption><p>A closer look at the chips for the remote control puck.</p></figcaption></figure><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-pcb-4.jpg alt="Picture showing"><figcaption><p>A closer look at the power regulation circuitry.</p></figcaption></figure><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/teardown-oem-esp-delid.jpg alt="Picture showing ESP module damaged by hotplate."><figcaption><p>This is what happens when you are impatient and set the hotplate to an aggressive temperature.</p></figcaption></figure><h2 id=esp32-retrofit>ESP32 Retrofit</h2><p>Fortunately, each wire connecting the ESP8266 module to the main PCB is clearly labeled.</p><table><thead><tr><th>Pin</th><th>Label</th><th>Description</th></tr></thead><tbody><tr><td>1</td><td><code>GND</code></td><td>Ground for the ESP module</td></tr><tr><td>2</td><td><code>3v3</code></td><td>Power for the ESP module</td></tr><tr><td>3</td><td><code>SCL</code></td><td>I2C. (probably, see note below)</td></tr><tr><td>4</td><td><code>SDA</code></td><td>I2C. (probably, see note below)</td></tr><tr><td>5</td><td><code>RGB</code></td><td>Standard neopixel data bus</td></tr><tr><td>6</td><td><code>C</code></td><td>PWM signal for cold white channel</td></tr><tr><td>7</td><td><code>EN</code></td><td>Master enable/disable for all light output</td></tr><tr><td>8</td><td><code>W</code></td><td>PWM signal for warm white channel</td></tr></tbody></table><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw"></i>I2C, probably<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>99% sure this is I2C for communications to the micro controller handing communication with the remote control puck.
There&rsquo;s nothing else on the PCB that would need I2C, but I haven&rsquo;t bothered to verify this&mldr; hence 99% sure.</div></div></div><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/esp-to-pcb-ribbon-closeup.jpg alt="I am eternally grateful for every PCB designer that bothers with clear silkscreen labels."><figcaption><p>I am eternally grateful for every PCB designer that bothers with clear silkscreen labels.</p></figcaption></figure><p>To drive the LEDs, we only need 4 GPIOs. Two for PWM channels and another two for master output enable and neopixels.</p><p>This makes it <em>trivial</em> to replace the ESP8266 based module with an ESP32.
The only catch is that the ESP32 module has to be <em>narrow</em> (if you want to fit it inside the tube).
If you don&rsquo;t care about that, you can use any ESP32 module you have on hand but you&rsquo;ll need to design/make a new enclosure for it.</p><p>I had a few of the incredibly tiny <a href=https://github.com/01Space/ESP32-C3-0.42LCD target=_blank rel="noopener noreffer">ESP32-C3-0.42LCD</a> modules on hand, so I used one and it <em>barely</em> fit:</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/images/esp32_inside.jpg alt="Tube is quite narrow and the ESP32 module takes up almost all of the available space."><figcaption><p>Tube is quite narrow and the ESP32 module takes up almost all of the available space.</p></figcaption></figure><p>All in all, you want to make sure the module is no more than ~20mm wide and probably not much longer than that either.
To make my life easier in the future, I soldered the ESP32 module to the main PCB with AWS30 wires about ~100mm long. You can see the colored wires in the photo above.</p><p>I was barely able to fit everything back into the tube.
You should probably use wires a bit shorter if you can.</p><p>In any case, the extra bulk from the wires and the ESP32 module meant that the OEM end cap would not fit back on the tube without some modifications.</p><p>Rather than play a game of &ldquo;cut some more plastic away and see if it fits yet&rdquo;, I decided to just model a new end cap in Fusion 360.
This replacement cap specifically does not have any features that extend deep into the tube so there&rsquo;s no risk of it interfering with the ESP32 module.</p><figure><img src=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/models/endcap.png alt="Suggested print orientation. Choose resolution, material and color to suit your needs."><figcaption><p>Suggested print orientation. Choose resolution, material and color to suit your needs.</p></figcaption></figure><p>You can download <code>endcap.step</code> file <a href=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/models/endcap.step rel>here</a>.
Print it in whatever material and color you want but be mindful of dimensional accuracy; the end cap is meant to be press-fit into the tube.</p><p>If you&rsquo;re confident that you&rsquo;ll never need to access the ESP32 module again, glue the end cap in place.</p><h3 id=esphome>ESPHome</h3><p>Here&rsquo;s a simple ESPHome config for the device.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>esphome</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Will boot loop w/o this when using the ESP-IDF and the C3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>platformio_options</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>board_build.flash_mode</span><span class=p>:</span><span class=w> </span><span class=l>dio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>esp32</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># There is no platform.io board for ESP32-C3-0.42LCD so use generic</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>board</span><span class=p>:</span><span class=w> </span><span class=l>esp32-c3-devkitm-1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>framework</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>esp-idf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Enable logging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>logger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>INFO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Requires ESP-IDF</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hardware_uart</span><span class=p>:</span><span class=w> </span><span class=l>USB_SERIAL_JTAG</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>light</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Primary&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>cwww</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>leds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cold_white</span><span class=p>:</span><span class=w> </span><span class=l>out_pwm_cw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>warm_white</span><span class=p>:</span><span class=w> </span><span class=l>out_pwm_ww</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># Marketing photos on ali express listing show a range of 2700K to 6500K</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>warm_white_color_temperature</span><span class=p>:</span><span class=w> </span><span class=l>2700K</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cold_white_color_temperature</span><span class=p>:</span><span class=w> </span><span class=l>6500K</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># With WW/CW on full, was drawing about 2.6-2.8A.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># The RGB added another .5A or so.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># The cw/ww strip is on a metal reflector which does mate with the aluminum case but</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#    i&#39;m not sure how much heat transfer there is.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>constant_brightness</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># See: https://esphome.io/components/light/esp32_rmt_led_strip</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Ambient&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>esp32_rmt_led_strip</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>pixels</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>GPIO10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>chipset</span><span class=p>:</span><span class=w> </span><span class=l>WS2812</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rmt_channel</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rgb_order</span><span class=p>:</span><span class=w> </span><span class=l>GRB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># There are two banks of 20</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>num_leds</span><span class=p>:</span><span class=w> </span><span class=m>40</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>output</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>out_pwm_ww</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>ledc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>GPIO08</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># Any lower than this and the LEDs don&#39;t turn on until ~ 15% or so</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>min_power</span><span class=p>:</span><span class=w> </span><span class=m>0.05</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># But when we hit off, we want it to be off</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>zero_means_zero</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>frequency</span><span class=p>:</span><span class=w> </span><span class=l>2441Hz</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>out_pwm_cw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>ledc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>GPIO07</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>zero_means_zero</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>min_power</span><span class=p>:</span><span class=w> </span><span class=m>0.05</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>frequency</span><span class=p>:</span><span class=w> </span><span class=l>2441Hz</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># PWM and RGB drivers can be enabled/disabled by a master on/off</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>switch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Master Output Enable&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class=l>sw_out_en</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class=l>gpio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pin</span><span class=p>:</span><span class=w> </span><span class=l>GPIO06</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=pcbic-markings>PCB/IC markings</h2><p>AKA the strings that I wish google had indexed when I was first looking for this info.</p><p>The front of the ESP8266 module is marked with:</p><ul><li><code>YEELIGHT</code></li><li><code>ESP8266NV1.0</code></li><li><code>LibraPro</code></li><li><code>WF-E266-RPY2</code></li><li><code>PN: 21500000028</code></li><li><code>CMIT ID: 2020DP12740</code></li></ul><p>The rear of the ESP8266 module is marked with:</p><ul><li><code>94V-0</code></li><li><code>S Y22M02D25</code></li><li><code>JU17.820.0767</code></li></ul><p>The main PCB is populated with:</p><ul><li><a href=https://wiki.telink-semi.cn/doc/ds/DS_TLSR8368-E_Datasheet%20for%20Telink%202.4GHz%20RF%20System-On-Chip%20Solution%20TLSR8368.pdf target=_blank rel="noopener noreffer"><code>TLSR8368EP16</code></a>: 2.4GHz RF System-On-Chip Solution for remote control puck</li><li><a href=https://datasheet.lcsc.com/lcsc/1810011020_FUDAN-MICRO-FM24C02C-SO-T-G_C189501.pdf target=_blank rel="noopener noreffer"><code>FM24C02C</code></a>: Flash rom for the <code>TLSR83</code>. I didn&rsquo;t bother to desolder and dump this chip.</li><li>3x ICs marked with <code>WRFAA</code> in a <code>2x5 SON</code> package. I can&rsquo;t find any info on these chips, but given that there are three LED channels and their proximity to power regulation circuitry, I assume that they are LED drivers.</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-09-21&nbsp;<a class=git-hash href=https://github.com/kquinsland/kquinsland.github.io/commit/5c031873d0496b61a2e64978b079c1552bb32ed8 target=_blank title="commit by karl(github@karlquinsland.com) 5c031873d0496b61a2e64978b079c1552bb32ed8: Few small typos / corrections / clarifications">
<i class="fas fa-hashtag fa-fw"></i>5c03187</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=https://karlquinsland.com/yeelight-monitor-lamp-teardown-esphome/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=https://karlquinsland.com/tags/esphome/>esphome</a>,&nbsp;<a href=https://karlquinsland.com/tags/home-assistant/>home assistant</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=https://karlquinsland.com/>Home</a></span></section></div><div class=post-nav><a href=https://karlquinsland.com/solum-el022hwra-teardown/ class=prev rel=prev title="Solum 2.2 inch Electronic Shelf Label Teardown"><i class="fas fa-angle-left fa-fw"></i>Solum 2.2 inch Electronic Shelf Label Teardown</a>
<a href=https://karlquinsland.com/sonoff-t5-esphome/ class=next rel=next title="ESPHome for Sonoff T5 family of Switches">ESPHome for Sonoff T5 family of Switches<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>¯\_(ツ)_/¯</div><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.120.4">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://karlquinsland.com/ target=_blank>karl</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://karlquinsland.com/lib/katex/katex.min.4710034e669c7ff17f823f9ba12cf8a36582d65b007f79cbc4a3c11d7db2e4ca.css integrity="sha256-RxADTmacf/F/gj+boSz4o2WC1lsAf3nLxKPBHX2y5Mo="><link rel=stylesheet href=https://karlquinsland.com/lib/katex/copy-tex.min.bf9ff4137fec38f6255419e142d0883c9c52090885d746f80eee12b273d9b3e0.css integrity="sha256-v5/0E3/sOPYlVBnhQtCIPJxSCQiF10b4Du4SsnPZs+A="><script type=text/javascript src=https://karlquinsland.com/lib/smooth-scroll/smooth-scroll.min.bcff85fb5e00d68802850b393ac7792c997f722f536f38e26638c46dca8e5eb6.js integrity="sha256-vP+F+14A1ogChQs5Osd5LJl/ci9TbzjiZjjEbcqOXrY="></script><script type=text/javascript src=https://karlquinsland.com/lib/autocomplete/autocomplete.min.615590a2ca2b667afa7c02ef396f5500b62e22795ddbb46448f90494605d09a5.js integrity="sha256-YVWQosorZnr6fALvOW9VALYuInld27RkSPkElGBdCaU="></script><script type=text/javascript src=https://karlquinsland.com/lib/lunr/lunr.min.df84a2d58ea594c04a3371b48d020b55ea10284c2ec636e4e331965d7313e29b.js integrity="sha256-34Si1Y6llMBKM3G0jQILVeoQKEwuxjbk4zGWXXMT4ps="></script><script type=text/javascript src=https://karlquinsland.com/lib/lazysizes/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js integrity="sha256-+2SfyuYhd9/mPmcIHdzrgwtc4fBaQYTpu7fYesS49OU="></script><script type=text/javascript src=https://karlquinsland.com/lib/clipboard/clipboard.min.8a7739925f4c03586479852df840b7061948832a7fda30c8c812d2ea4dd4c4f2.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI="></script><script type=text/javascript src=https://karlquinsland.com/lib/katex/katex.min.17f5dd6b9f123dd7140abfb18521b3f4c036cd004f6f40121182a8865f140877.js integrity="sha256-F/Xda58SPdcUCr+xhSGz9MA2zQBPb0ASEYKohl8UCHc="></script><script type=text/javascript src=https://karlquinsland.com/lib/katex/auto-render.min.f74776a677f0d2be0af0264058f928e2ba455d0b19bc985304660d922a43a6b2.js integrity="sha256-90d2pnfw0r4K8CZAWPko4rpFXQsZvJhTBGYNkipDprI="></script><script type=text/javascript src=https://karlquinsland.com/lib/katex/copy-tex.min.2ab2237329021bc443986c8327f6e61357fb68a54e5d233d224023718c02207d.js integrity="sha256-KrIjcykCG8RDmGyDJ/bmE1f7aKVOXSM9IkAjcYwCIH0="></script><script type=text/javascript src=https://karlquinsland.com/lib/katex/mhchem.min.5cea356d6025c5a2f18c454c83ec5674dbb04fab1cd1d75569e77788c6b6f888.js integrity="sha256-XOo1bWAlxaLxjEVMg+xWdNuwT6sc0ddVaed3iMa2+Ig="></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=https://karlquinsland.com/js/theme.min.f51938f3065a40ee841bcb558e4330e31fd26c0ea55343fff8770b88b0319a3c.js integrity="sha256-9Rk48wZaQO6EG8tVjkMw4x/SbA6lU0P/+HcLiLAxmjw="></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3WZ55XG701",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-3WZ55XG701" async></script></body></html>