<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=X-UA-Compatible content="IE=edge, chrome=1"><title>Enhanced Home Assistant Switch Plate (HASP) - karl</title><meta name=Description content="A few new hardware features and software tweaks to make the wonderful HASP project even better"><meta property="og:url" content="https://karlquinsland.com/enhanced-homeassistantswitchplate/">
<meta property="og:site_name" content="karl"><meta property="og:title" content="Enhanced Home Assistant Switch Plate (HASP)"><meta property="og:description" content="A few new hardware features and software tweaks to make the wonderful HASP project even better"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-01T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-14T10:11:49-07:00"><meta property="article:tag" content="Fusion-360"><meta property="article:tag" content="Has:download"><meta property="article:tag" content="Home-Assistant"><meta property="og:image" content="https://karlquinsland.com/enhanced-homeassistantswitchplate/images/installed.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://karlquinsland.com/enhanced-homeassistantswitchplate/images/installed.jpg"><meta name=twitter:title content="Enhanced Home Assistant Switch Plate (HASP)"><meta name=twitter:description content="A few new hardware features and software tweaks to make the wonderful HASP project even better"><meta name=twitter:site content="@somerandomguy"><meta name=application-name content="karl"><meta name=apple-mobile-web-app-title content="karl"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=https://karlquinsland.com/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://karlquinsland.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://karlquinsland.com/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://karlquinsland.com/apple-touch-icon.png><link rel=mask-icon href=https://karlquinsland.com/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=https://karlquinsland.com/site.webmanifest><link rel=canonical href=https://karlquinsland.com/enhanced-homeassistantswitchplate/><link rel=prev href=https://karlquinsland.com/ws3-weather-station-pm25-sensor/><link rel=next href=https://karlquinsland.com/two-tasmota-rules/><link rel=stylesheet href=https://karlquinsland.com/lib/normalize/normalize.min.055364f5be272caa092b0e6654c165828707f8ab971e2656383a6d6392bc345e.css integrity="sha256-BVNk9b4nLKoJKw5mVMFlgocH+KuXHiZWODptY5K8NF4="><link rel=stylesheet href=https://karlquinsland.com/css/style.min.1e2694bed152fa2922dbe909a441838ed693d88b1330f97485bfa8ed78da42df.css integrity="sha256-HiaUvtFS+iki2+kJpEGDjtaT2IsTMPl0hb+o7XjaQt8="><link rel=stylesheet href=https://karlquinsland.com/lib/fontawesome-free/all.min.876d023d9d10c97941b80c3b03e2a5b94631ff7a4af9cee5604a6a2d39718d84.css integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ="><link rel=stylesheet href=https://karlquinsland.com/lib/animate/animate.min.3c770e90f98eb21b0c042fafb49755af93306fbaf42e449524f94fae9fc83295.css integrity="sha256-PHcOkPmOshsMBC+vtJdVr5Mwb7r0LkSVJPlPrp/IMpU="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Enhanced Home Assistant Switch Plate (HASP)","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/karlquinsland.com\/enhanced-homeassistantswitchplate\/"},"genre":"posts","keywords":"fusion-360, has:download, home assistant","wordcount":3716,"url":"https:\/\/karlquinsland.com\/enhanced-homeassistantswitchplate\/","datePublished":"2020-10-01T00:00:00+00:00","dateModified":"2022-05-14T10:11:49-07:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":"A few new hardware features and software tweaks to make the wonderful HASP project even better"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=https://karlquinsland.com/ title=karl>Karl</a></div><div class=menu><div class=menu-inner><a class=menu-item href=https://karlquinsland.com/posts/><i class="fas fa-blog"></i> Posts </a><a class=menu-item href=https://karlquinsland.com/resume/ title="Hire Me!"><i class="fas fa-briefcase"></i> R√©sum√© </a><a class=menu-item href=https://karlquinsland.com/tags/ title="Can you tell that I don't have a super consistent or clear taxonomy?"><i class="fas fa-tags"></i> Tags </a><a class=menu-item href=https://karlquinsland.com/contact/><i class="fas fa-address-book"></i> Contact </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=https://karlquinsland.com/ title=karl>Karl</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=https://karlquinsland.com/posts/ title><i class="fas fa-blog"></i>Posts</a><a class=menu-item href=https://karlquinsland.com/resume/ title="Hire Me!"><i class="fas fa-briefcase"></i>R√©sum√©</a><a class=menu-item href=https://karlquinsland.com/tags/ title="Can you tell that I don't have a super consistent or clear taxonomy?"><i class="fas fa-tags"></i>Tags</a><a class=menu-item href=https://karlquinsland.com/contact/ title><i class="fas fa-address-book"></i>Contact</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Enhanced Home Assistant Switch Plate (HASP)</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://karlquinsland.com/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Author</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-10-01>2020-10-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;3716 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;18 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#modifications>Modifications</a><ul><li><a href=#software>Software</a></li><li><a href=#hardware>Hardware</a><ul><li><a href=#the-enclosure>The enclosure</a></li></ul></li></ul></li><li><a href=#assembly>Assembly</a><ul><li><a href=#additional-materials>Additional Materials</a></li><li><a href=#brass-inserts>Brass inserts</a></li><li><a href=#wire-harness>Wire Harness</a><ul><li><ul><li><a href=#ldr>LDR</a></li><li><a href=#leds>LEDs</a></li><li><a href=#pin-header>Pin Header</a></li></ul></li></ul></li><li><a href=#printing>Printing</a><ul><li><a href=#thermals>Thermals</a></li></ul></li></ul></li><li><a href=#future-work>Future work</a></li><li><a href=#files>Files</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>The <a href=https://github.com/aderusha/HASwitchPlate/ target=_blank rel="noopener noreffer">HASwitchPlate</a> project by <code>aderusha</code> is brilliant. He&rsquo;s managed to arrange some relatively cheap commodity hardware into a package that conveniently fits into a prime location for interacting with Home Automation - the light switch. The entire package sips power off of the already present mains wiring and connects to any MQTT broker via the esp8266 chip. As the HASP was designed to be used with Home Assistant, the humble 2.4 inch LCD transforms into an accessible control surface for an incredibly powerful home automation platform!</p><h2 id=modifications>Modifications</h2><p>First, a brief word about indemnification:</p><blockquote><p>All instructions and information on this page is purely for informational purposes.</p><p>The original HASP and my modifications come with neither an expressed or implied warranty. By constructing your own, you assume all risk.</p></blockquote><h3 id=software>Software</h3><p>The few software modifications I&rsquo;ve made to the HASP project are relatively small and don&rsquo;t implement anything significant or new; they are &lsquo;quality of life&rsquo; improvements that target small portions of the code.</p><p>I strongly believe that the hardest part of using a given piece automation technology should be taking it out of the box. To wit, Home Assistant has robust - <a href=https://community.home-assistant.io/t/ability-to-set-entity-icon-through-mqtt-discovery/224538 target=_blank rel="noopener noreffer">but not perfect</a> - support for <a href=https://www.home-assistant.io/docs/mqtt/discovery/ target=_blank rel="noopener noreffer">automatic device discovery and configuration via MQTT</a>. Once a device has connected to the MQTT broker, it simply publishes a document detailing how HA should interface with the device. It&rsquo;s a wonderful experience to see a new device connect to the network for the first time and just a few seconds later the new device is registered in HA, waiting for you to start integrating it into automations ü§©ü§§.</p><p>While there are quite a few sensors/stateful-attributes in the original HASP code, none of them automatically present themselves to Home Assistant üòî. I set about fixing that to the best of my abilities. Unfortunately, the LCD backlight is the only peripheral that could be &lsquo;upgraded&rsquo; to automatic configuration without making a ton of changes to the original code base.</p><p>All of the hardware modifications detailed below automatically configure themselves with Home Assistant.</p><p>The original HASP code base uses allocates too little memory for storing MQTT credentials. Any username or password longer than 31 bytes/characters would be <strong>silently</strong> truncated on save. Despite the &lsquo;credentials saved, rebooting&rsquo; message, the next screen was always a &lsquo;failure to connect&rsquo; message. Frustrating! The pull request to address this is <a href=https://github.com/aderusha/HASwitchPlate/pull/117 target=_blank rel="noopener noreffer">here</a>.</p><h3 id=hardware>Hardware</h3><p>The HASP does support dimming the LCD, but it has no awareness of ambient light levels. This makes it rather difficult to deploy a HASP in any &rsquo;light sensitive&rsquo; location like a bedroom or media room without another device to cue Home Assistant and lower the LCD brightness. Workable, but too high friction to be ideal.</p><p>Light Dependent Resistors - <a href=https://en.wikipedia.org/wiki/Photoresistor target=_blank rel="noopener noreffer">LDR</a> for short - are a very cheap and compact way to get an approximate light level. Fortunately, the analogue pin is broken out on the <a href=https://github.com/aderusha/HASwitchPlate/tree/master/PCB target=_blank rel="noopener noreffer">PCB</a> so a simple <a href=https://en.wikipedia.org/wiki/Voltage_divider#Resistive_divider target=_blank rel="noopener noreffer">resistive divider</a> and a few lines of code are all that&rsquo;s needed to get a a number that linearly correlates to the level of light hitting the face plate.</p><p>It just so happens that there is <em>just enough</em> room to fit a LDR beneath the surface of the decor plate and out of the way of the LCD. As (not) shown in the picture above, there is no way to tell that the LDR is embedded beneath the surface.</p><p>The range of values from the LDR isn&rsquo;t great, but they are adequate enough to reliably detect if the HASP is in a darkened room.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/ldr-graph.jpg alt="Screenshot depicting graph of LDR values, rising over time. Annotated to indicate sharp rise in brightness right around sunrise"><figcaption><p>ignore the spikes just before noon, those are due to to testing with a flash light</p></figcaption></figure><p>While researching potential ways to measure the ambient brightness, I stumbled across the <a href=https://shop.homeseer.com/products/z-wave-dimmer-switch target=_blank rel="noopener noreffer">HomeSeer HS-WD200+</a> which features a rather novel way to convey additional information to a user; seven RGB leds üòç. It&rsquo;s a brilliant use of such a simple and ubiquitous technology that I&rsquo;m not really sure why every smart switch doesn&rsquo;t do this!</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/HS-WD200-Modes.jpg alt="Picture showing tools/materials required for assembly"><figcaption><p>HomeSeer's WS200 has a delightful innovation... RGB LEDs!</p></figcaption></figure><p>With <em>zero</em> room to spare, four LEDs can fit into a small cavity between the LCD and decor plate surface. Like with the LDR, there is no visual &rsquo;tell&rsquo; that there are LEDs beneath the surface&mldr; unless they&rsquo;re on, of course.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/prototype-leds.jpg alt="Picture showing a prototype HASP with LEDs embedded beneath the surface and powered on"><figcaption><p>Ignore the dirt on the switch. Notice how you can't tell there's an LDR beneath the surface</p></figcaption></figure><h4 id=the-enclosure>The enclosure</h4><p>Without consuming more than 1 <a href=https://diy.stackexchange.com/questions/11654/what-does-1-gang-2-gang-and-so-forth-mean-when-talking-about-electrical-bo target=_blank rel="noopener noreffer">gang</a>, the only realistic way to get the wires for the new components to the HASP PCB is to go around the edge of the LCD&rsquo;s PCB. This is accomplished with two small &lsquo;channels&rsquo; that slightly protrude in the vertical directions from the lip around the LCD and into the box that encloses the electronics.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/CAD-channel-profile.jpg alt="Screenshot of Fusion360, showing side profile of HASP, annotated to indicate channels in enclosure for wires leading to LED tape, LDR in relation to LCD"><figcaption><p>Section analysis from f360 showing small channels around the LCD for wires to LDR and LEDs</p></figcaption></figure><p>Additionally, I found that the original printed parts do not properly fit in the <a href=https://www.amazon.com/Thomas-Betts-B232A-UPC-Carlon-Bulk/dp/B000GAWYZ8/ target=_blank rel="noopener noreffer">two gang electrical box</a> where I intended to deploy the HASP.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/electric-box-clearance.jpg alt="Closeup photograph of prototype HASP enclosure and 2-gang electric box. Annotated to show interfering surfaces"><figcaption><p>The only way to fit the HASP in my 2-gang electric boxes is to cut out a small section</p></figcaption></figure><p>In total, the modifications required to accommodate the LDR and LED tape are relatively small, but <a href=https://github.com/aderusha/HASwitchPlate/issues/116 target=_blank rel="noopener noreffer">I had to re-create the model from scratch</a> so several things are likely a bit different from the original model. It should be relatively easy to port the modifications to the other multi-gang configurations that the original HASP supports.</p><p>The <code>.step</code> and <code>.f3z</code> files are available should you want to make the necessary modifications to other switch plate configurations.
The <code>.stl</code> and <code>.3mf</code> files are available for easy printing.</p><p>All files available <a href=#files rel>below</a> and on <a href=https://github.com/kquinsland/HASwitchPlate/tree/master/3D_Printable_Models/enhanced-HASP target=_blank rel="noopener noreffer">github</a>.</p><h2 id=assembly>Assembly</h2><p>The steps below are meant to be followed between the original steps <a href=https://github.com/aderusha/HASwitchPlate/blob/master/Documentation/03_Electronics_Assembly.md target=_blank rel="noopener noreffer"><code>03_Electronics_Assembly</code></a> and <a href=https://github.com/aderusha/HASwitchPlate/blob/master/Documentation/04_Project_Enclosure.md target=_blank rel="noopener noreffer"><code>04_Project_Enclosure</code></a>.</p><p>In short, you&rsquo;ll want to assemble and test the HASP PCB as in the original instructions, but use the steps below as a substitute for the enclosure assembly process.</p><h3 id=additional-materials>Additional Materials</h3><p>In addition to everything in the original BOM, you&rsquo;ll need:</p><ul><li><p>A LDR. Be aware that LDRs come in many different shapes and sizes and have different resistance values. Space is rather tight, so the form factor matters a lot more than the resistance values or band of light that the LDR responds to. If you use a different LDR, you may need to adjust the resistor value to better match your LDR. You can get 50 of the exact model GL5516 that I used for less than $2 <a href=https://s.click.aliexpress.com/e/_dUjV8Rn target=_blank rel="noopener noreffer">here</a>.</p></li><li><p>A 10KŒ© resistor to form a simple resistive divider with the LDR. This will better map the the full range of the LDR to the 0-1 volt range that the ESP8266 ADC uses. Space is rather limited so the smaller the resistor, the better; no need for anything larger than 1/4 Watt. You can get a 10-pack of 10KŒ© resistors <a href="https://rover.ebay.com/rover/1/711-53200-19255-0/1?mpre=https%3A%2F%2Fwww.ebay.com%2Fitm%2F10-Pcs-1-8-Watt-1-Metal-Film-Resistor-Choose-you-own-values-USA-SELLER%2F302971259661&amp;campid=5338745533&amp;toolid=10001&amp;customid=" target=_blank rel="noopener noreffer">here</a></p></li><li><p>WS2812B LED tape <strong>featuring the 3535SMD package</strong>. The &lsquo;regular size&rsquo; LED package <em>will <strong>not</strong> fit</em> so make sure you use the smaller <code>3535SMD</code> package! Beyond that, aim for LED tape that is no wider than ~8mm and has highest density possible. After quite some searching, the best that I could find is 8mm wide tape with a density of 144 LEDs per meter. Unfortunately, they don&rsquo;t sell LEDs 4 at a time, so you can pick up 1 meter of the exact LEDs I used <a href="https://rover.ebay.com/rover/1/711-53200-19255-0/1?mpre=https%3A%2F%2Fwww.ebay.com%2Fitm%2FNarrow-DC-5V-WS2812B-Led-Strip-Individually-Addressable-WS2812-Led-pixel-Light%2F254647279915%3Fhash%3Ditem3b4a29212b%3Ag%3A9D8AAOSwIZ5fBTn7&amp;campid=5338745533&amp;toolid=10001&amp;customid=pixel_tape" target=_blank rel="noopener noreffer">here</a>.</p></li><li><p>Several centimeters of very fine gauge wire. Ideally, multiple colors so you can keep organized but this is not required. Again, space is rather tight, so AWG 28 or 30 is ideal. Much bigger than that and you&rsquo;ll likely have issues fitting everything together. You can get a 1m length of multiple colors <a href="https://rover.ebay.com/rover/1/711-53200-19255-0/1?mpre=https%3A%2F%2Fwww.ebay.com%2Fitm%2FNarrow-DC-5V-WS2812B-Led-Strip-Individually-Addressable-WS2812-Led-pixel-Light%2F254647279915%3Fhash%3Ditem3b4a29212b%3Ag%3A9D8AAOSwIZ5fBTn7&amp;campid=5338745533&amp;toolid=10001" target=_blank rel="noopener noreffer">here</a>.</p></li><li><p>HeatShrink Tubing (HST). The exact diameter needed will depend on how compact your soldering is and the size of resistor used. Multiple colors will help keep things organized, but that&rsquo;s not required. I suggest a kit so you can get the perfect diameter and length. You can get a kit <a href="https://rover.ebay.com/rover/1/711-53200-19255-0/1?mpre=https%3A%2F%2Fwww.ebay.com%2Fitm%2F360pcs-2-1-Heat-Shrink-Tube-Tubing-Sleeving-Wrap-Wire-cable-Insulated-Assorted%2F224122863249%3Fhash%3Ditem342ec37e91%3Ag%3AMbcAAOSwXGhfPCNK&amp;campid=5338745533&amp;toolid=10001" target=_blank rel="noopener noreffer">here</a>.</p></li><li><p>Standard 2.54mm pin headers. You can get a set of male and female headers <a href="https://rover.ebay.com/rover/1/711-53200-19255-0/1?mpre=https%3A%2F%2Fwww.ebay.com%2Fitm%2F10pcs-Male-Header-1x40-2-54mm-40-Pin-PCB-Through-Hole-Arduino-and-Pi%2F223105297271%3Fepid%3D28022683725%26hash%3Ditem33f21cab77%3Ag%3A~X8AAOSwvFpbdZWA&amp;campid=5338745533&amp;toolid=10001" target=_blank rel="noopener noreffer">here</a>.</p></li></ul><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/00.prep-electronics.jpg alt="Picture showing the additional electronic components for mod"><figcaption><p>All the components needed for assembly</p></figcaption></figure><p><strong>Note</strong>: Where possible, I&rsquo;ve used commission links. The links don&rsquo;t raise the price of any item, they simply let the retailer know that I&rsquo;m the reason for your business. In return, I get a small cut of your purchase as a &rsquo;thanks&rsquo; from the retailer. If you&rsquo;re not comfortable with that, you can use a URL unwinding service to get the &lsquo;raw&rsquo; product link and drop the attribution/commission part.</p><h3 id=brass-inserts>Brass inserts</h3><p>The original instructions suggest using glue to secure the brass inserts to the face plate, but I suggest using either a lighter or a very fine tip soldering iron to heat up the brass insert. A hot insert will melt the surrounding plastic which will make for a much stronger joint. The modified version of the HASP face plate used in this guide intentionally features holes slightly too small for the brass inserts so glue won&rsquo;t be enough.</p><p>Fully insert the 20mm screw into the brass insert, use pliers to grasp the screw and apply heat with a lighter for a few seconds and then insert into the face plate. Make sure that the screw is <strong>completely</strong> inserted into the insert so that molten plastic can&rsquo;t flow into the insert. If molten plastic enters and cools on the threads, it will be rather difficult to later screw things together!</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/01.prep-brass-inserts.jpg alt="Picture showing a 20mm screw fully inserted into brass threaded insert"><figcaption><p>Molten plastic can't flow into a filled insert</p></figcaption></figure><p>As the inserts cool, you&rsquo;ll have a few seconds to make adjustments to their orientation before they become fixed. Make sure that each screw is vertical and cool to the touch before moving on to the wiring harness.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/02.inserts-cooling.jpg alt="Picture showing threaded inserts inserted into faceplate with screws sticking out, pointed vertically"><figcaption><p>screws make it easy to perform final alignment on inserts and act as a heatsink</p></figcaption></figure><h3 id=wire-harness>Wire Harness</h3><p>There are only six wires for the two components and the LED tape is the only component where polarity matters. A table mapping each pin on the HASP PCB to each component lead is below.</p><table><thead><tr><th>HASP PCB Pin</th><th>Component</th></tr></thead><tbody><tr><td>GND</td><td>LED Tape, 10KŒ© resistor</td></tr><tr><td>+5V</td><td>LED Tape VCC in</td></tr><tr><td>+3.3V</td><td>LDR</td></tr><tr><td>A0</td><td>LDR & 10KŒ© resistor junction</td></tr><tr><td>D0</td><td>N/A</td></tr><tr><td>D1</td><td>LED Tape CLK/DTA in</td></tr><tr><td>D2</td><td>N/A</td></tr><tr><td>DBG</td><td>N/A</td></tr></tbody></table><p>You are <strong>strongly</strong> encouraged to test / check your work after each step with a simple multimeter. Complete assembly involves irreversible steps, like shrinking HST. If you make a mistake, it&rsquo;s best to catch it before &lsquo;finalizing&rsquo; things as you&rsquo;re almost certainly going to have to destroy the component and or wiring harness to repair it.</p><p>Additionally, you can flash my <a href=https://github.com/kquinsland/HASwitchPlate target=_blank rel="noopener noreffer">modified HASP firmware</a> to a fully assembled HASP device and use that as a testing device. On boot up, the modified firmware briefly flashes each LED in sequence. About every 10 seconds after boot, the LDR value will be read and published to MQTT. Cover the LDR with your hand and check your MQTT broker or HA to confirm that the value changes significantly between exposed and covered states.</p><h5 id=ldr>LDR</h5><p>Fit the LDR into the face plate and position the leads in the channel under and to the top of the LCD PCB. Then trim the excess length off of the LDR leads so that they extend &lsquo;beyond&rsquo; the LCD by about 8mm or so.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/03.ldr-position.jpg alt="Picture showing the LDR in position under the LCD with it's leads trimmed slightly"><figcaption><p>LDR under the LCD w/ trimmed leads...</p></figcaption></figure><p>Remove the LDR from the face plate and straighten the leads out. Lay the LDR, resistor, and wire out as shown below. Use this time to cut the HST down to size so everything but the leg of the LDR that joins the resistor can be covered. <strong>Note:</strong> the leads on the resistor have also been trimmed down to ~15mm to better fit.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/04.wire-harness.jpg alt="Picture showing rough layout of LDR and related components"><figcaption><p>rough layout of LDR harness</p></figcaption></figure><p>It&rsquo;s probably going to be easiest to start with the &lsquo;supply&rsquo; wire which runs directly from the HASP PCB&rsquo;s +3.3v pin to the LDR. As space is exceedingly tight, there is no room for overly large solder joints. Carefully wrap the wire around the lead and apply just enough solder to make good electrical contact. Once the supply wire has been soldered to the LDR, affix the HST so the entirety of the lead and solder joint are protected.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/05.ldr-wire-wrap.jpg alt="picture showing wire wrapped around the lead of LDR prior to soldering"><figcaption><p>strip ~1cm off the end of the wire, wrap around the lead, then solder</p></figcaption></figure><p>Repeat the same procedure with the lead of the resistor that will go directly to the ground. Affix the HST after the solder joint has cooled.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/06.ldr-ground.jpg alt="picture showing sire soldered to the 'ground-facing' lead of the 10k resistor with heat shrink tubing about to be applied"><figcaption><p>No room for mechanically strong solder joints</p></figcaption></figure><p>Use the same &lsquo;wrap&rsquo; technique with the remaining leads from the LDR and the resistor. Apply just enough solder for good electrical contact between the signal wire and the two leads of the LDR and resistor.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/07.ldr-signal.jpg alt="picture showing wire wrapped around the LDR and 10K resistor leads"><figcaption><p>same wrapping technique, just with two leads this time</p></figcaption></figure><p>After the solder joint cools, cover the entire LDR/Resistor assembly in HST so there is no exposed wire or component lead.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/08.hst.jpg alt="Picture showing rough layout of LDR and related components"><figcaption><p>get everything nicely protected behind HST</p></figcaption></figure><p>Set the LDR component aside for now and move on to the LED tape.</p><h5 id=leds>LEDs</h5><p>If you&rsquo;ve not already trimmed the LED tape to fit in the face plate, do so now. Leave yourself as much room as needed to solder on the one side where you&rsquo;ll need to feed power and data in.</p><p>The LED tape has incredibly small pads so take your time on this. You have about 5 cubic millimeters <em>total</em> for the three solder joints on the LED tape. Solder just enough for electrical contact, there will be no significant mechanical stress. <strong>Note:</strong> The arrows printed on the strip point in the direction of data flow; combined with the off-center placement of the LED packages, there is only one way to properly install the LED tape in the decor plate.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/09.wire-alignment.jpg alt="picture showing wire lined up with one solder pad on the LED tape "><figcaption><p>know which way the LED tape wires will need to point to make it into the 'channel' prior to soldering</p></figcaption></figure><p>After soldering the power, signal and ground wires, flatten them and gently shape them so they align and flow into the channel on the face plate in a manner similar to the LDR. For a bit of mechanical robustness, consider braiding the wires together.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/10.twisted-cable.jpg alt="picture showing three wires from LED tape carefully braised together for a more compact and stronger cable"><figcaption><p>twist the wires together for a more compact and robust cable</p></figcaption></figure><h5 id=pin-header>Pin Header</h5><p>After soldering wires onto the two components, all that&rsquo;s left is soldering the wires to the correct pins on the pin header.</p><p>One at a time, carefully take the pins out of the plastic &lsquo;frame&rsquo;. This is to prevent the heat from the soldering and HST steps from melting the plastic. Consider marking the pin with the location of the &lsquo;frame&rsquo; so you don&rsquo;t take up too much room with the solder joint. You will need the &lsquo;business end&rsquo; of the pin to make good contact with the socket on the HASP board; this is quite difficult if most of the pin can&rsquo;t be slid through the &lsquo;frame&rsquo; because of an excessively large solder joint!</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/11.process.jpg alt="picture showing single pin removed from pin header, about to be soldered"><figcaption><p>remove the pin from the plastic 'frame' and carefully solder the wires to the pins</p></figcaption></figure><p>Make sure that HST is on the wire(s) <em>before</em> soldering! After the solder joint cools, slip the HST over the solder joint and apply heat until the joint is covered. Repeat this process for the remaining pins. There will be three &lsquo;unused&rsquo; pins that you can just ignore.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/12.unused-pins.jpg alt="picture showing the unused pins in the wire harness"><figcaption><p>A few pins are not needed</p></figcaption></figure><p>When all the wires have been soldered and covered, you&rsquo;ll have something that looks like this:</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/13.harness-finished.jpg alt="picture showing each component in the decor plate and the finished wiring harness."><figcaption></figcaption></figure><p>Double check electrical connections and then combine the PCB, enclosure, plate and harness. Carefully align the &lsquo;channels&rsquo; for LDR and LED wires:</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/14.finished.jpg alt="picture of finished assembly ready to be screwed together. Annotated to call attention to pinch points w/ wires"><figcaption><p>Align and ensure no pinched wires!</p></figcaption></figure><h3 id=printing>Printing</h3><p>In the electrical boxes there&rsquo;s absolutely no room to spare, so all parts are designed to fit together with <strong>very</strong> tight clearances. Print as slow as you need to in order too achieve very good dimensional accuracy. Like with the brass inserts, the various screw holes are intentionally undersized for better thread engagement.</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/suggested-print.jpg alt="Screenshot showing modified enclosure files in slicer for 3d printer"><figcaption><p>The obvious orientation is the best, no supports needed</p></figcaption></figure><p>The HASP does run a bit warm, but not any warmer than other smart switches with similar form-factor. PLA will likely be fine unless you in tend to deploy the HASP in a particularly hot location.</p><h4 id=thermals>Thermals</h4><p>In testing, the parts of the HASP ran ~20¬∫ above ambient. Most of that heat comes from the small AC->DC converter and the LCD. Surprisingly, the ESP8266 does not emit that much heat. Overall, nothing particularly alarming, especially when the HASP is deployed into a larger multi-gang electrical box with with plenty of air to radiate heat into. Apologies in advance for the mixed ¬∫C/¬∫F units.</p><p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/01.removed-side-rear.png alt="photo from a thermal camera showing the HASP device removed from it's electrical box, the sides and rear are warm"><figcaption><p>HASP removed from electrical box, heat from the AC-DC converter radiating through the enclosure</p></figcaption></figure><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/02.removed-top-side.png alt="photo from a thermal camera showing the HASP device removed from it's electrical box, the sides and rear are warm"><figcaption><p>similar to first picture, parts inside enclosure radiate heat through the enclosure, bringing it to about 20 degrees above ambient temperature</p></figcaption></figure><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/03.removed-rear-side.png alt="photo from a thermal camera showing the HASP device removed from it's electrical box, the sides and rear are warm"><figcaption><p>there are clear hot-spots on the enclosure that match up with the location of the ESP and the AC-DC converter</p></figcaption></figure><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/04.front-leds-on.png alt="photo from a thermal camera showing the HASP device installed in its electrical enclosure. The LCD and LEDs are the warmest part"><figcaption><p>Less heat is radiated through the front of the HASP; the LCD backlight and embedded LEDs are clearly the warmest components</p></figcaption></figure></p><p>The tiny PNP transistor that toggles the LCD power is the hottest component, by far. Everything else has a relatively consistent temperature:</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/05.internals.png alt="photo from a thermal camera showing the internals of deployed HASP; the AC->DC converter is clearly the warmest object"><figcaption><p>PNP Transistor is clearly warmest internal component, ESP8266 cooler than expected</p></figcaption></figure><p>When installed in wall, the HASP is radiating heat into the electrical box and through neighboring switches:</p><figure><img src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/06.installed-markup.jpg alt="photo from a thermal camera showing the HASP as deployed in wall. Heat is evenly radiated through LCD and through neighboring switch"><figcaption><p>a little bit of ambient heat radiating through the gap between LCD and switch as well as through the switch</p></figcaption></figure><h2 id=future-work>Future work</h2><p>I did accomplish my two main goals:</p><ol><li>Ambient light sensor for more responsive backlight control</li><li>HomeSeer-like LEDs for additional information display</li></ol><p>However, there&rsquo;s a few aspects of the HASP that i&rsquo;d like to further improve:</p><ul><li><p>Increased automatic configuration w/ the HASP. There&rsquo;s still a non-trivial amount of work required to set up a HASP with Home Assistant. The HASP device has many different attributes that could be exposed to Home Assistant automatically. E.G.: The HASP will periodically check for a firmware update; the HASP should configure Home Assistant with a <a href=https://www.home-assistant.io/integrations/binary_sensor.mqtt/#configuration target=_blank rel="noopener noreffer"><code>binary_sensor</code></a> that indicates if there&rsquo;s a firmware update available.</p></li><li><p>Some of the automations that live in Home Assistant to manage button presses / update screen content could probably be re-factored down to a few generic scripts and services.</p></li><li><p>The display uses a <a href=https://forum.digikey.com/t/resistive-touch-vs-capacitive-touch-whats-the-difference/1063 target=_blank rel="noopener noreffer">resistive matrix</a> to detect touch events. Resistive screens, while cheap, are a bit finnicky and inferior to the more consistent and precise capacitive touch screen tech. If Nextion ever makes a capacitive version of the NX3224T024, then it would be an instant upgrade!</p></li><li><p>Similarly, the viewing angle on the LCD is&mldr; not great. The HASP, like most light switches, is at a convenient height for hands&mldr; not eyes. If you&rsquo;re standing relatively close to the HASP, you&rsquo;ll be looking down at the screen with quite a steep angle. Depending on the current screen brightness and colors, this may result in a washed out and illegible screen.</p></li><li><p>Better LED diffusion. There&rsquo;s not a lot of space for light pipes or similar, but I would like to find a better way of diffusing the LEDs. Or even to fit a masking layer between the LEDs and the plate, so the effect would be akin to a back-lit silhouette.</p></li><li><p>Effects for the LEDs. Right now, the LEDs only support on/off/brightness commands. Their ability to passively indicate information would be enhanced if Home Assistant could send &rsquo;effect&rsquo; commands, too. E.G.: Rather than HA having to send a constant stream of color/brightness commands to fade between blue, green, yellow, purple, simply send a <code>fade(2s) blue, green, yellow, purple</code> command.</p></li><li><p>There&rsquo;s plenty of spare room on the HASP PCB for the 10KŒ© resistor. This would simplify the creation of the wiring harness. I&rsquo;ve been meaning to learn KiKad, this might be a very gentle way to start learning it. ü§î</p></li><li><p>Enclose the LED tape 100% inside the HASP. This version works well and the small &lsquo;hole&rsquo; in the enclosure. I don&rsquo;t think there&rsquo;s any safety concern w/ the current design, but I&rsquo;d still like to have the low voltage stuff 100% blocked off from thee electrical box&mldr;</p></li></ul><h2 id=files>Files</h2><p>For archive / posterity, all source files are included here. Unless otherwise explicitly stated otherwise, all files below are licensed as <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel="noopener noreffer">Creative Commons Attribution-NonCommercial-ShareAlike</a> (CC BY-NC-SA).</p><ul><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/CAD-channel-profile.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/CAD-channel-profile_hu7631092598330808037.jpg width=300 height=125></a><figcaption><small>Section analysis from f360 showing small channels around the LCD for wires to LDR and LEDs</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/electric-box-clearance.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/electric-box-clearance_hu7624119783969146745.jpg width=300 height=205></a><figcaption><small>The only way to fit the HASP in my 2-gang electric boxes is to cut out a small section</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/00.prep-electronics.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/00.prep-electronics_hu14163088519970377154.jpg width=300 height=190></a><figcaption><small>All the components needed for assembly</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/01.prep-brass-inserts.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/01.prep-brass-inserts_hu17316016139072358822.jpg width=300 height=169></a><figcaption><small>Molten plastic can't flow into a filled insert</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/02.inserts-cooling.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/02.inserts-cooling_hu13408692238922766018.jpg width=300 height=166></a><figcaption><small>screws make it easy to perform final alignment on inserts and act as a heatsink</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/03.ldr-position.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/03.ldr-position_hu18244855625149119018.jpg width=300 height=143></a><figcaption><small>LDR under the LCD w/ trimmed leads...</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/04.wire-harness.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/04.wire-harness_hu8627956482568945107.jpg width=300 height=169></a><figcaption><small>rough layout of LDR harness</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/05.ldr-wire-wrap.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/05.ldr-wire-wrap_hu11517289336159058767.jpg width=300 height=165></a><figcaption><small>strip ~1cm off the end of the wire, wrap around the lead, then solder</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/06.ldr-ground.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/06.ldr-ground_hu12103717061446989383.jpg width=300 height=155></a><figcaption><small>No room for mechanically strong solder joints</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/07.ldr-signal.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/07.ldr-signal_hu3302967557799111287.jpg width=300 height=169></a><figcaption><small>same wrapping technique, just with two leads this time</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/08.hst.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/08.hst_hu1376043208257785794.jpg width=300 height=200></a><figcaption><small>get everything nicely protected behind HST</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/09.wire-alignment.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/09.wire-alignment_hu15577695639521790310.jpg width=300 height=212></a><figcaption><small>know which way the LED tape wires will need to point to make it into the 'channel' prior to soldering</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/10.twisted-cable.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/10.twisted-cable_hu5121428166624023214.jpg width=300 height=219></a><figcaption><small>twist the wires together for a more compact and robust cable</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/11.process.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/11.process_hu13605167187621853431.jpg width=300 height=251></a><figcaption><small>remove the pin from the plastic 'frame' and carefully solder the wires to the pins</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/12.unused-pins.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/12.unused-pins_hu1002896580788758945.jpg width=300 height=284></a><figcaption><small>A few pins are not needed</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/13.harness-finished.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/13.harness-finished_hu8404890249475144073.jpg width=300 height=311></a></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/14.finished.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/assembly/14.finished_hu5005239491421453053.jpg width=300 height=179></a><figcaption><small>Align and ensure no pinched wires!</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/installed.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/installed_hu2870990544385006518.jpg width=300 height=285></a><figcaption><small>If the LEDs weren't on, you'd never know they were there üòä</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/ldr-graph.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/ldr-graph_hu5990354965659796652.jpg width=300 height=300></a><figcaption><small>ignore the spikes just before noon, those are due to to testing with a flash light</small></figcaption></figure></li><li><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/models/box.step><i class="far fa-file-code"></i>
models/box.step:
<small style="font-family:lucida console,monospace">step</small> <small>file</small></a></li><li><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/models/box.stl><i class="far fa-file-code"></i>
models/box.stl:
<small style="font-family:lucida console,monospace">stl</small> <small>file</small></a></li><li><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/models/combined.3mf><i class="far fa-file-archive"></i>
models/combined.3mf:
<small style="font-family:lucida console,monospace">3mf</small> <small>file</small></a></li><li><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/models/combined.step><i class="far fa-file-code"></i>
models/combined.step:
<small style="font-family:lucida console,monospace">step</small> <small>file</small></a></li><li><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/models/enhanced-HASP.f3z><i class="far fa-file-"></i>
models/enhanced-HASP.f3z:</a></li><li><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/models/plate.step><i class="far fa-file-code"></i>
models/plate.step:
<small style="font-family:lucida console,monospace">step</small> <small>file</small></a></li><li><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/models/plate.stl><i class="far fa-file-code"></i>
models/plate.stl:
<small style="font-family:lucida console,monospace">stl</small> <small>file</small></a></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/prototype-leds.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/prototype-leds_hu14464303123006334602.jpg width=300 height=304></a><figcaption><small>Ignore the dirt on the switch. Notice how you can't tell there's an LDR beneath the surface</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/suggested-print.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/suggested-print_hu14743677536409209330.jpg width=300 height=165></a><figcaption><small>The obvious orientation is the best, no supports needed</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/01.removed-side-rear.png><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/01.removed-side-rear_hu1059327919657555752.png width=300 height=400></a><figcaption><small>HASP removed from electrical box, heat from the AC-DC converter radiating through the enclosure</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/02.removed-top-side.png><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/02.removed-top-side_hu14764245685054545689.png width=300 height=400></a><figcaption><small>similar to first picture, parts inside enclosure radiate heat through the enclosure, bringing it to about 20 degrees above ambient temperature</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/03.removed-rear-side.png><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/03.removed-rear-side_hu14033449987339344837.png width=300 height=400></a><figcaption><small>there are clear hot-spots on the enclosure that match up with the location of the ESP and the AC-DC converter</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/04.front-leds-on.png><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/04.front-leds-on_hu8963942008606529557.png width=300 height=400></a><figcaption><small>Less heat is radiated through the front of the HASP; the LCD backlight and embedded LEDs are clearly the warmest components</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/05.internals.png><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/05.internals_hu5976756638931601003.png width=300 height=400></a><figcaption><small>PNP Transistor is clearly warmest internal component, ESP8266 cooler than expected</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/06.installed-markup.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/thermals/06.installed-markup_hu16374895297737082546.jpg width=300 height=400></a><figcaption><small>a little bit of ambient heat radiating through the gap between LCD and switch as well as through the switch</small></figcaption></figure></li><li><figure><a target=_blank href=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/HS-WD200-Modes.jpg><img style=width:auto;height:auto src=https://karlquinsland.com/enhanced-homeassistantswitchplate/images/HS-WD200-Modes_hu16745563459290871245.jpg width=300 height=300></a><figcaption><small>HomeSeer's WS200 has a delightful innovation... RGB LEDs!</small></figcaption></figure></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-05-14&nbsp;<a class=git-hash href=https://github.com/kquinsland/kquinsland.github.io/commit/ba3ab63795b02f26e35bde78a6b778a46b2486e6 target=_blank title="commit by karl(github@karlquinsland.com) ba3ab63795b02f26e35bde78a6b778a46b2486e6: re-locate everything into a better organized folder structure">
<i class="fas fa-hashtag fa-fw"></i>ba3ab63</a></span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=https://karlquinsland.com/enhanced-homeassistantswitchplate/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=https://karlquinsland.com/tags/fusion-360/>Fusion-360</a>,&nbsp;<a href></a>,&nbsp;<a href=https://karlquinsland.com/tags/home-assistant/>Home-Assistant</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=https://karlquinsland.com/>Home</a></span></section></div><div class=post-nav><a href=https://karlquinsland.com/ws3-weather-station-pm25-sensor/ class=prev rel=prev title="Adding an airborne particulate mater sensor to WS3 Weather Station"><i class="fas fa-angle-left fa-fw"></i>Adding an airborne particulate mater sensor to WS3 Weather Station</a>
<a href=https://karlquinsland.com/two-tasmota-rules/ class=next rel=next title="Two Tasmota rules">Two Tasmota rules<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>¬Ø\_(„ÉÑ)_/¬Ø</div><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.136.5">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2019 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://karlquinsland.com/ target=_blank></a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=https://karlquinsland.com/lib/katex/katex.min.4710034e669c7ff17f823f9ba12cf8a36582d65b007f79cbc4a3c11d7db2e4ca.css integrity="sha256-RxADTmacf/F/gj+boSz4o2WC1lsAf3nLxKPBHX2y5Mo="><link rel=stylesheet href=https://karlquinsland.com/lib/katex/copy-tex.min.bf9ff4137fec38f6255419e142d0883c9c52090885d746f80eee12b273d9b3e0.css integrity="sha256-v5/0E3/sOPYlVBnhQtCIPJxSCQiF10b4Du4SsnPZs+A="><script type=text/javascript src=https://karlquinsland.com/lib/smooth-scroll/smooth-scroll.min.bcff85fb5e00d68802850b393ac7792c997f722f536f38e26638c46dca8e5eb6.js integrity="sha256-vP+F+14A1ogChQs5Osd5LJl/ci9TbzjiZjjEbcqOXrY="></script><script type=text/javascript src=https://karlquinsland.com/lib/autocomplete/autocomplete.min.615590a2ca2b667afa7c02ef396f5500b62e22795ddbb46448f90494605d09a5.js integrity="sha256-YVWQosorZnr6fALvOW9VALYuInld27RkSPkElGBdCaU="></script><script type=text/javascript src=https://karlquinsland.com/lib/lunr/lunr.min.df84a2d58ea594c04a3371b48d020b55ea10284c2ec636e4e331965d7313e29b.js integrity="sha256-34Si1Y6llMBKM3G0jQILVeoQKEwuxjbk4zGWXXMT4ps="></script><script type=text/javascript src=https://karlquinsland.com/lib/lazysizes/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js integrity="sha256-+2SfyuYhd9/mPmcIHdzrgwtc4fBaQYTpu7fYesS49OU="></script><script type=text/javascript src=https://karlquinsland.com/lib/clipboard/clipboard.min.8a7739925f4c03586479852df840b7061948832a7fda30c8c812d2ea4dd4c4f2.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI="></script><script type=text/javascript src=https://karlquinsland.com/lib/katex/katex.min.17f5dd6b9f123dd7140abfb18521b3f4c036cd004f6f40121182a8865f140877.js integrity="sha256-F/Xda58SPdcUCr+xhSGz9MA2zQBPb0ASEYKohl8UCHc="></script><script type=text/javascript src=https://karlquinsland.com/lib/katex/auto-render.min.f74776a677f0d2be0af0264058f928e2ba455d0b19bc985304660d922a43a6b2.js integrity="sha256-90d2pnfw0r4K8CZAWPko4rpFXQsZvJhTBGYNkipDprI="></script><script type=text/javascript src=https://karlquinsland.com/lib/katex/copy-tex.min.2ab2237329021bc443986c8327f6e61357fb68a54e5d233d224023718c02207d.js integrity="sha256-KrIjcykCG8RDmGyDJ/bmE1f7aKVOXSM9IkAjcYwCIH0="></script><script type=text/javascript src=https://karlquinsland.com/lib/katex/mhchem.min.5cea356d6025c5a2f18c454c83ec5674dbb04fab1cd1d75569e77788c6b6f888.js integrity="sha256-XOo1bWAlxaLxjEVMg+xWdNuwT6sc0ddVaed3iMa2+Ig="></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=https://karlquinsland.com/js/theme.min.f51938f3065a40ee841bcb558e4330e31fd26c0ea55343fff8770b88b0319a3c.js integrity="sha256-9Rk48wZaQO6EG8tVjkMw4x/SbA6lU0P/+HcLiLAxmjw="></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-3WZ55XG701",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-3WZ55XG701" async></script></body></html>